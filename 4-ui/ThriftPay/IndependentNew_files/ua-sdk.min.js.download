/*! UA-Web-Push: d9c11e9:1684945003972 */!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=56)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={VERSION:"1.20.5",configured:!1,workerUrl:"/push-worker.js",apiUrl:"https://aswpapius.com",storagePrefix:"_ua_sdk",deprecatedStoragePrefix:null,disableAnalytics:!1,appKey:null,secret:null,token:null,defaultIcon:"",defaultTitle:"",defaultActionURL:"",vapidPublicKey:null,debug:!1,websitePushId:null,registrationDomain:null,mixedRegistrationDomains:!1,secureHost:"",secureBridgePath:null,secureBridgeUrl:null,dataCollectionOptInEnabled:!1,secureIframeUrl:null,skipWaiting:!0,allowedDomains:null,loadIfPushNotSupported:!1,trackEventsForOptOutChannels:!1,safariServiceUrl:"https://aswpapius.com/api/safari/web-service/",paths:{cla:"/api/channels",cra:"/api/web-channels",tags:"/api/web-channels/tags",attributes:"/api/channels/attributes",custom_events:"/api/web-events/custom",remote_data:{app:"/api/remote-data/app"},subscription_lists:{list:"/api/subscription_lists/channels",update:"/api/channels/subscription_lists"},named_user:{associate:"/api/named_users/associate",disassociate:"/api/named_users/disassociate",tags:"/api/named_users/tags"},contact:{identify:"/api/contacts/identify",resolve:"/api/contacts/resolve",reset:"/api/contacts/reset",batch:"/api/contacts",subscription_lists_list:"/api/subscription_lists/contacts",registration:{email:"/api/channels/restricted/email",sms:"/api/channels/restricted/sms",open:"/api/channels/restricted/open"}},reports:{direct:"/api/web-events/direct",session:"/api/web-events/session",customEvent:"/api/web-events/custom"}},consts:{DISABLE_ANALYTICS:"disable_analytics"},contacts:{sessionLengthMs:36e5,namedUserTtlMs:2592e6,_forceExpireNamedUsers:!1},subscriptionLists:{cacheTtlMs:3e5},remoteData:{cacheTtlMs:6e5}};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(36).default((function(){return r.default.storagePrefix+":db"}),"blob",{keyPath:"type"},(function(t){var e;return null===(e=t.target.result)||void 0===e?void 0:e.value}),1);e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=new WeakMap,i=new WeakMap;function o(t){const e=r.get(t);return console.assert(null!=e,"'this' is expected an Event object, but got",t),e}function a(t){null==t.passiveListener?t.event.cancelable&&(t.canceled=!0,"function"==typeof t.event.preventDefault&&t.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",t.passiveListener)}function s(t,e){r.set(this,{eventTarget:t,event:e,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:e.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=Object.keys(e);for(let t=0;t<n.length;++t){const e=n[t];e in this||Object.defineProperty(this,e,u(e))}}function u(t){return{get(){return o(this).event[t]},set(e){o(this).event[t]=e},configurable:!0,enumerable:!0}}function c(t){return{value(){const e=o(this).event;return e[t].apply(e,arguments)},configurable:!0,enumerable:!0}}function l(t){if(null==t||t===Object.prototype)return s;let e=i.get(t);return null==e&&(e=function(t,e){const n=Object.keys(e);if(0===n.length)return t;function r(e,n){t.call(this,e,n)}r.prototype=Object.create(t.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(let i=0;i<n.length;++i){const o=n[i];if(!(o in t.prototype)){const t="function"==typeof Object.getOwnPropertyDescriptor(e,o).value;Object.defineProperty(r.prototype,o,t?c(o):u(o))}}return r}(l(Object.getPrototypeOf(t)),t),i.set(t,e)),e}function f(t){return o(t).immediateStopped}function d(t,e){o(t).passiveListener=e}s.prototype={get type(){return o(this).event.type},get target(){return o(this).eventTarget},get currentTarget(){return o(this).currentTarget},composedPath(){const t=o(this).currentTarget;return null==t?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return o(this).eventPhase},stopPropagation(){const t=o(this);t.stopped=!0,"function"==typeof t.event.stopPropagation&&t.event.stopPropagation()},stopImmediatePropagation(){const t=o(this);t.stopped=!0,t.immediateStopped=!0,"function"==typeof t.event.stopImmediatePropagation&&t.event.stopImmediatePropagation()},get bubbles(){return Boolean(o(this).event.bubbles)},get cancelable(){return Boolean(o(this).event.cancelable)},preventDefault(){a(o(this))},get defaultPrevented(){return o(this).canceled},get composed(){return Boolean(o(this).event.composed)},get timeStamp(){return o(this).timeStamp},get srcElement(){return o(this).eventTarget},get cancelBubble(){return o(this).stopped},set cancelBubble(t){if(!t)return;const e=o(this);e.stopped=!0,"boolean"==typeof e.event.cancelBubble&&(e.event.cancelBubble=!0)},get returnValue(){return!o(this).canceled},set returnValue(t){t||a(o(this))},initEvent(){}},Object.defineProperty(s.prototype,"constructor",{value:s,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(s.prototype,window.Event.prototype),i.set(window.Event.prototype,s));const h=new WeakMap;function p(t){return null!==t&&"object"==typeof t}function v(t){const e=h.get(t);if(null==e)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return e}function y(t,e){Object.defineProperty(t,"on"+e,function(t){return{get(){let e=v(this).get(t);for(;null!=e;){if(3===e.listenerType)return e.listener;e=e.next}return null},set(e){"function"==typeof e||p(e)||(e=null);const n=v(this);let r=null,i=n.get(t);for(;null!=i;)3===i.listenerType?null!==r?r.next=i.next:null!==i.next?n.set(t,i.next):n.delete(t):r=i,i=i.next;if(null!==e){const i={listener:e,listenerType:3,passive:!1,once:!1,next:null};null===r?n.set(t,i):r.next=i}},configurable:!0,enumerable:!0}}(e))}function b(t){function e(){g.call(this)}e.prototype=Object.create(g.prototype,{constructor:{value:e,configurable:!0,writable:!0}});for(let n=0;n<t.length;++n)y(e.prototype,t[n]);return e}function g(){if(!(this instanceof g)){if(1===arguments.length&&Array.isArray(arguments[0]))return b(arguments[0]);if(arguments.length>0){const t=new Array(arguments.length);for(let e=0;e<arguments.length;++e)t[e]=arguments[e];return b(t)}throw new TypeError("Cannot call a class as a function")}h.set(this,new Map)}g.prototype={addEventListener(t,e,n){if(null==e)return;if("function"!=typeof e&&!p(e))throw new TypeError("'listener' should be a function or an object.");const r=v(this),i=p(n),o=(i?Boolean(n.capture):Boolean(n))?1:2,a={listener:e,listenerType:o,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null};let s=r.get(t);if(void 0===s)return void r.set(t,a);let u=null;for(;null!=s;){if(s.listener===e&&s.listenerType===o)return;u=s,s=s.next}u.next=a},removeEventListener(t,e,n){if(null==e)return;const r=v(this),i=(p(n)?Boolean(n.capture):Boolean(n))?1:2;let o=null,a=r.get(t);for(;null!=a;){if(a.listener===e&&a.listenerType===i)return void(null!==o?o.next=a.next:null!==a.next?r.set(t,a.next):r.delete(t));o=a,a=a.next}},dispatchEvent(t){if(null==t||"string"!=typeof t.type)throw new TypeError('"event.type" should be a string.');const e=v(this),n=t.type;let r=e.get(n);if(null==r)return!0;const i=function(t,e){return new(l(Object.getPrototypeOf(e)))(t,e)}(this,t);let a=null;for(;null!=r;){if(r.once?null!==a?a.next=r.next:null!==r.next?e.set(n,r.next):e.delete(n):a=r,d(i,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,i)}catch(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t)}else 3!==r.listenerType&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(i);if(f(i))break;r=r.next}return d(i,null),function(t,e){o(t).eventPhase=e}(i,0),function(t,e){o(t).currentTarget=e}(i,null),!i.defaultPrevented}},Object.defineProperty(g.prototype,"constructor",{value:g,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(g.prototype,window.EventTarget.prototype),e.defineEventAttribute=y,e.EventTarget=g,e.default=g,t.exports=g,t.exports.EventTarget=t.exports.default=g,t.exports.defineEventAttribute=y},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0);e.default=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(o.default.debug){if(1===t.length&&(Array.isArray(t[0])||"object"==typeof t[0])&&console.table)return console.table(t[0]);console.log.apply(console,i([],r(t)))}}},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.getIntlDetails=e.getTranslation=void 0,e.getTranslation=function(t,e){var n=Object.keys(t).reduce((function(e,n){return e[n.toLowerCase()]=t[n],e}),{}),r=Object.keys(n),i=window.navigator.languages.map((function(t){return t.toLowerCase()})),o=i.find((function(t){return r.includes(t)}));if(o)return n[o];var a=r.find((function(t){return i.includes(t.substr(0,2))}));return a?n[a]:n[e.toLowerCase()]||n.en},e.getIntlDetails=function(t){var e=Intl.DateTimeFormat().resolvedOptions(),n=e.timeZone,i=r(e.locale.split("-"),2),o=i[0],a=i[1],s=(null==t?void 0:t.language)||o,u=(null==t?void 0:t.country)||a;return!u&&navigator.languages&&(u=navigator.languages.reduce((function(t,e){return t||(t=e.includes("-")?e.split("-")[1]:null),t}),null)||""),{localeCountry:u,localeLanguage:s,timezone:n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(3);e.default=function(t,e){t=""+r.default.apiUrl+t;var n={Accept:"application/vnd.urbanairship+json; version=3;"};if(r.default.appKey&&r.default.token)n["X-UA-Appkey"]=r.default.appKey,n.Authorization="Bearer "+r.default.token;else if(r.default.appKey&&r.default.secret){var o=self.btoa(r.default.appKey+":"+r.default.secret);n.Authorization="Basic "+o}return e.credentials="include",e.body&&(n["Content-type"]="application/json","string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.headers=e.headers||{},Object.assign(e.headers,n),i.default("REQUEST",t,e),self.fetch(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return window.location}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return void 0===t&&(t=self),!("PushManager"in t)&&!!("safari"in t||navigator.userAgent.match(/Safari/)&&!navigator.userAgent.match(/Chrome/))}},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=["tags","channel"];function a(t){return i.default.storagePrefix+":"+t}e.default={set:function(t,e){var n;return null===(n=self.localStorage)||void 0===n?void 0:n.setItem(a(t),e)},get:function(t){var e;return null===(e=self.localStorage)||void 0===e?void 0:e.getItem(a(t))},setJSON:function(t,e){return this.set(t,JSON.stringify(e))},getJSON:function(t){var e=this.get(t);if(e)return JSON.parse(e)},clear:function(){var t;null===(t=self.localStorage)||void 0===t||t.clear()},remove:function(t){var e;return null===(e=self.localStorage)||void 0===e?void 0:e.removeItem(a(t))},onStorage:function(t){return function(e){var n,a;try{for(var s=r(o),u=s.next();!u.done;u=s.next()){var c=u.value,l=i.default.storagePrefix+":"+c;if(e.key===l){var f={};f[c]=JSON.parse(e.newValue||""),t(f)}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}}}}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.setDataCollectionEnabled=e.isDataCollectionEnabled=void 0;var o=n(0),a=n(1);e.isDataCollectionEnabled=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return t=o.default.dataCollectionOptInEnabled,[4,a.default.get("dataCollectionEnabled")];case 1:return void 0!==(e=n.sent())?[2,e]:[4,a.default.set("dataCollectionEnabled",!t)];case 2:return n.sent(),[2,!t]}}))}))},e.setDataCollectionEnabled=function(t,e){var n,o,s,u,c,l;return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return t?[3,3]:(null===(o=null===(n=e.channel)||void 0===n?void 0:n.tags)||void 0===o||o.clear(),[4,null===(u=null===(s=e.channel)||void 0===s?void 0:s.namedUser)||void 0===u?void 0:u.remove()]);case 1:return r.sent(),[4,null===(c=e.channel)||void 0===c?void 0:c.optOut()];case 2:return r.sent(),[3,5];case 3:return"granted"!==e.permission?[3,5]:[4,null===(l=e.channel)||void 0===l?void 0:l.set({opt_in:!0})];case 4:r.sent(),r.label=5;case 5:return[4,a.default.set("dataCollectionEnabled",t)];case 6:return r.sent(),[2]}}))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.apiTimestamp=void 0,e.apiTimestamp=function(t){return(null!=t?t:new Date).toISOString().split(".")[0]}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ValidationError=e.DataCollectionDisabledError=void 0;var o=function(t){function e(n){void 0===n&&(n="Data collection is not enabled.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error);e.DataCollectionDisabledError=o;var a=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error);e.ValidationError=a},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),s=function(){function t(t){this._country=null,this._language=null,this._channel=null,(null==t?void 0:t.country)&&this.setCountry(null==t?void 0:t.country),(null==t?void 0:t.language)&&this.setLanguage(null==t?void 0:t.language)}return Object.defineProperty(t.prototype,"country",{get:function(){return this._country},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){return this._language},enumerable:!1,configurable:!0}),t.getStoredLocale=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return[4,a.default.get("localeOverride")];case 1:return[2,{country:(null==(t=e.sent())?void 0:t.locale_country)||null,language:(null==t?void 0:t.locale_language)||null}]}}))}))},t.fromStorage=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,t.getStoredLocale()];case 1:return[2,new t(e.sent())]}}))}))},t.prototype.setCountry=function(t){return"string"==typeof t&&2!==t.trim().length?Promise.reject("setCountry(): country should be two characters long"):(this._country="string"==typeof t?t.trim().toUpperCase():null,this._store())},t.prototype.setLanguage=function(t){return"string"==typeof t&&2!==t.trim().length?Promise.reject("setLanguage(): language should be two characters long"):(this._language="string"==typeof t?t.trim().toLowerCase():null,this._store())},t.prototype.set=function(t){var e=[];return void 0!==t.country&&e.push(this.setCountry(t.country)),void 0!==t.language&&e.push(this.setLanguage(t.language)),Promise.all(e).then((function(){}))},t.prototype.setChannel=function(t){this._channel=t,this._channel._setLocaleOverride(this)},t.prototype.clear=function(){var t=this;return this._language=null,this._country=null,a.default.remove("localeOverride").then((function(){var e;return null===(e=t._channel)||void 0===e?void 0:e._store(!1)})).then((function(){}))},t.prototype.toJSON=function(){return r(r({},this.country?{locale_country:this.country}:{}),this.language?{locale_language:this.language}:{})},t.prototype._store=function(){var t,e;return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,a.default.set("localeOverride",this.toJSON())];case 1:return n.sent(),[4,null===(t=this._channel)||void 0===t?void 0:t._store(!1)];case 2:return n.sent(),[4,null===(e=this._channel)||void 0===e?void 0:e.update()];case 3:return n.sent(),[2]}}))}))},t}();e.default=s},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(37),o=n(0),a=n(4),s=["chrome","edge","firefox","opera","safari","yandex browser"];e.default=function(t){var e=t.optedIn,n=t.localeOverride,u=i.parse(navigator.userAgent),c=u.browser,l=u.platform,f={};try{var d=a.getIntlDetails(n),h=d.localeCountry,p=d.localeLanguage;f={timezone:d.timezone,locale_country:h,locale_language:p}}catch(t){}var v=navigator.userAgent,y=function(t){if(!t)return"unknown";if(t=t.toLowerCase(),!s.includes(t))return"unknown";return t.split(" ")[0]}(c.name),b=y+"-"+c.version,g="mobile"===l.type||"tablet"===l.type?"mobile":"desktop",_=o.default.VERSION;return r(r({},f),{device_type:"web",opt_in:e,web:{user_agent_string:v,browser_name:y,browser_version:b,browser_type:g,web_sdk_version:_}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isWebPushSupported=void 0;var r=n(0),i=n(7),o=["indexedDB","localStorage","fetch","crypto"];function a(){var t=navigator.userAgent.match(/Chrome\/(\d\d)\./);return!(t&&Number(t[1])<52)&&Boolean("PushManager"in window||i.default()&&r.default.websitePushId&&"safari"in window&&"pushNotification"in window.safari)}e.default=function(){var t=o.every((function(t){return t in window}));return r.default.loadIfPushNotSupported?t:t&&a()},e.isWebPushSupported=a},,,function(t,e,n){"use strict";var r;n.r(e),n.d(e,"v1",(function(){return v})),n.d(e,"v3",(function(){return O})),n.d(e,"v4",(function(){return E})),n.d(e,"v5",(function(){return C})),n.d(e,"NIL",(function(){return k})),n.d(e,"version",(function(){return T})),n.d(e,"validate",(function(){return s})),n.d(e,"stringify",(function(){return d})),n.d(e,"parse",(function(){return y}));var i=new Uint8Array(16);function o(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(t){return"string"==typeof t&&a.test(t)},u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));var l,f,d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n},h=0,p=0;var v=function(t,e,n){var r=e&&n||0,i=e||new Array(16),a=(t=t||{}).node||l,s=void 0!==t.clockseq?t.clockseq:f;if(null==a||null==s){var u=t.random||(t.rng||o)();null==a&&(a=l=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==s&&(s=f=16383&(u[6]<<8|u[7]))}var c=void 0!==t.msecs?t.msecs:Date.now(),v=void 0!==t.nsecs?t.nsecs:p+1,y=c-h+(v-p)/1e4;if(y<0&&void 0===t.clockseq&&(s=s+1&16383),(y<0||c>h)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=c,p=v,f=s;var b=(1e4*(268435455&(c+=122192928e5))+v)%4294967296;i[r++]=b>>>24&255,i[r++]=b>>>16&255,i[r++]=b>>>8&255,i[r++]=255&b;var g=c/4294967296*1e4&268435455;i[r++]=g>>>8&255,i[r++]=255&g,i[r++]=g>>>24&15|16,i[r++]=g>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var _=0;_<6;++_)i[r+_]=a[_];return e||d(i)};var y=function(t){if(!s(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n};var b=function(t,e,n){function r(t,r,i,o){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof r&&(r=y(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+t.length);if(a.set(r),a.set(t,r.length),(a=n(a))[6]=15&a[6]|e,a[8]=63&a[8]|128,i){o=o||0;for(var s=0;s<16;++s)i[o+s]=a[s];return i}return d(a)}try{r.name=t}catch(t){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r};function g(t){return 14+(t+64>>>9<<4)+1}function _(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function m(t,e,n,r,i,o){return _((a=_(_(e,t),_(r,o)))<<(s=i)|a>>>32-s,n);var a,s}function w(t,e,n,r,i,o,a){return m(e&n|~e&r,t,e,i,o,a)}function S(t,e,n,r,i,o,a){return m(e&r|n&~r,t,e,i,o,a)}function P(t,e,n,r,i,o,a){return m(e^n^r,t,e,i,o,a)}function M(t,e,n,r,i,o,a){return m(n^(e|~r),t,e,i,o,a)}var O=b("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){for(var e=[],n=32*t.length,r=0;r<n;r+=8){var i=t[r>>5]>>>r%32&255,o=parseInt("0123456789abcdef".charAt(i>>>4&15)+"0123456789abcdef".charAt(15&i),16);e.push(o)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[g(e)-1]=e;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,a=0;a<t.length;a+=16){var s=n,u=r,c=i,l=o;n=w(n,r,i,o,t[a],7,-680876936),o=w(o,n,r,i,t[a+1],12,-389564586),i=w(i,o,n,r,t[a+2],17,606105819),r=w(r,i,o,n,t[a+3],22,-1044525330),n=w(n,r,i,o,t[a+4],7,-176418897),o=w(o,n,r,i,t[a+5],12,1200080426),i=w(i,o,n,r,t[a+6],17,-1473231341),r=w(r,i,o,n,t[a+7],22,-45705983),n=w(n,r,i,o,t[a+8],7,1770035416),o=w(o,n,r,i,t[a+9],12,-1958414417),i=w(i,o,n,r,t[a+10],17,-42063),r=w(r,i,o,n,t[a+11],22,-1990404162),n=w(n,r,i,o,t[a+12],7,1804603682),o=w(o,n,r,i,t[a+13],12,-40341101),i=w(i,o,n,r,t[a+14],17,-1502002290),r=w(r,i,o,n,t[a+15],22,1236535329),n=S(n,r,i,o,t[a+1],5,-165796510),o=S(o,n,r,i,t[a+6],9,-1069501632),i=S(i,o,n,r,t[a+11],14,643717713),r=S(r,i,o,n,t[a],20,-373897302),n=S(n,r,i,o,t[a+5],5,-701558691),o=S(o,n,r,i,t[a+10],9,38016083),i=S(i,o,n,r,t[a+15],14,-660478335),r=S(r,i,o,n,t[a+4],20,-405537848),n=S(n,r,i,o,t[a+9],5,568446438),o=S(o,n,r,i,t[a+14],9,-1019803690),i=S(i,o,n,r,t[a+3],14,-187363961),r=S(r,i,o,n,t[a+8],20,1163531501),n=S(n,r,i,o,t[a+13],5,-1444681467),o=S(o,n,r,i,t[a+2],9,-51403784),i=S(i,o,n,r,t[a+7],14,1735328473),r=S(r,i,o,n,t[a+12],20,-1926607734),n=P(n,r,i,o,t[a+5],4,-378558),o=P(o,n,r,i,t[a+8],11,-2022574463),i=P(i,o,n,r,t[a+11],16,1839030562),r=P(r,i,o,n,t[a+14],23,-35309556),n=P(n,r,i,o,t[a+1],4,-1530992060),o=P(o,n,r,i,t[a+4],11,1272893353),i=P(i,o,n,r,t[a+7],16,-155497632),r=P(r,i,o,n,t[a+10],23,-1094730640),n=P(n,r,i,o,t[a+13],4,681279174),o=P(o,n,r,i,t[a],11,-358537222),i=P(i,o,n,r,t[a+3],16,-722521979),r=P(r,i,o,n,t[a+6],23,76029189),n=P(n,r,i,o,t[a+9],4,-640364487),o=P(o,n,r,i,t[a+12],11,-421815835),i=P(i,o,n,r,t[a+15],16,530742520),r=P(r,i,o,n,t[a+2],23,-995338651),n=M(n,r,i,o,t[a],6,-198630844),o=M(o,n,r,i,t[a+7],10,1126891415),i=M(i,o,n,r,t[a+14],15,-1416354905),r=M(r,i,o,n,t[a+5],21,-57434055),n=M(n,r,i,o,t[a+12],6,1700485571),o=M(o,n,r,i,t[a+3],10,-1894986606),i=M(i,o,n,r,t[a+10],15,-1051523),r=M(r,i,o,n,t[a+1],21,-2054922799),n=M(n,r,i,o,t[a+8],6,1873313359),o=M(o,n,r,i,t[a+15],10,-30611744),i=M(i,o,n,r,t[a+6],15,-1560198380),r=M(r,i,o,n,t[a+13],21,1309151649),n=M(n,r,i,o,t[a+4],6,-145523070),o=M(o,n,r,i,t[a+11],10,-1120210379),i=M(i,o,n,r,t[a+2],15,718787259),r=M(r,i,o,n,t[a+9],21,-343485551),n=_(n,s),r=_(r,u),i=_(i,c),o=_(o,l)}return[n,r,i,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,n=new Uint32Array(g(e)),r=0;r<e;r+=8)n[r>>5]|=(255&t[r/8])<<r%32;return n}(t),8*t.length))}));var E=function(t,e,n){var r=(t=t||{}).random||(t.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return d(r)};function A(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}function x(t,e){return t<<e|t>>>32-e}var C=b("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var r=unescape(encodeURIComponent(t));t=[];for(var i=0;i<r.length;++i)t.push(r.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,a=Math.ceil(o/16),s=new Array(a),u=0;u<a;++u){for(var c=new Uint32Array(16),l=0;l<16;++l)c[l]=t[64*u+4*l]<<24|t[64*u+4*l+1]<<16|t[64*u+4*l+2]<<8|t[64*u+4*l+3];s[u]=c}s[a-1][14]=8*(t.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(t.length-1)&4294967295;for(var f=0;f<a;++f){for(var d=new Uint32Array(80),h=0;h<16;++h)d[h]=s[f][h];for(var p=16;p<80;++p)d[p]=x(d[p-3]^d[p-8]^d[p-14]^d[p-16],1);for(var v=n[0],y=n[1],b=n[2],g=n[3],_=n[4],m=0;m<80;++m){var w=Math.floor(m/20),S=x(v,5)+A(w,y,b,g)+_+e[w]+d[m]>>>0;_=g,g=b,b=x(y,30)>>>0,y=v,v=S}n[0]=n[0]+v>>>0,n[1]=n[1]+y>>>0,n[2]=n[2]+b>>>0,n[3]=n[3]+g>>>0,n[4]=n[4]+_>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),k="00000000-0000-0000-0000-000000000000";var T=function(t){if(!s(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TagAction=e.AttributeAction=void 0,function(t){t.SET="set",t.REMOVE="remove"}(e.AttributeAction||(e.AttributeAction={})),function(t){t.ADD="add",t.SET="set",t.REMOVE="remove"}(e.TagAction||(e.TagAction={}))},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),a=n(20),s=n(5),u=n(6),c=n(8),l=n(74),f=n(75),d=function(){function t(t,e,n,r){if(void 0===n&&(n={}),!t)throw new ReferenceError("argument: `name` is required.");var i=c.default.getJSON("channel");if(!(null==i?void 0:i.channel_id))throw new ReferenceError("You must have a registered channel to send events.");this._channel=i,this._name=t,this.value=e,this.properties=n,this.transactionId=r,this.interactionId=u.default().href,this.interactionType="url"}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){if(t&&(t=Number(t),Number.isNaN(t)||"number"!=typeof t))throw new TypeError("`value` must be a number");this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t.prototype._prepareProperties=function(){return this.properties},t.prototype._prepareInteractionId=function(){return r(this,void 0,void 0,(function(){var t,e,n;return i(this,(function(r){switch(r.label){case 0:return this.interactionId===u.default().href&&this.interactionId.length<=255?[2,!1]:(t=new window.TextEncoder("utf-8").encode(this.interactionId),[4,window.crypto.subtle.digest("SHA-256",t)]);case 1:return e=r.sent(),n=Array.from(new Uint8Array(e)).map((function(t){return("0"+t.toString(16)).slice(-2)})).join(""),this.interactionId=this.interactionId.slice(0,230)+"..."+n.slice(0,20),[2,!0]}}))}))},t.prototype.validate=function(){var t=this._prepareProperties();this._validateProperties(t);l.checkStrings(this,["name","transactionId","interactionId","interactionId"])},t.prototype._validateProperties=function(t){if(Array.isArray(t)||"object"!=typeof t)throw new TypeError("CustomEvent: properties must be an object");var e;try{e=JSON.stringify(t)}catch(t){throw new TypeError("CustomEvent: properties must be JSON serializable.")}if(e.length>32768)throw new RangeError("CustomEvent: properties are "+e.length+" when JSON encoded, exceeding the maximum of 32768.")},t.prototype._validateBooleanProperty=function(t){if(this.properties&&this.properties.hasOwnProperty(t)&&"boolean"!=typeof this.properties[t])throw new TypeError("CustomEvent property '"+t+"' must be a Boolean")},t.prototype._validateIsoDateProperty=function(t){if(this.properties&&this.properties.hasOwnProperty(t)&&!f(this.properties[t]))throw new TypeError("CustomEvent property '"+t+"' must be an ISO_8601 date string")},t.prototype.toJSON=function(){var t=c.default.getJSON("session")||{},e={web_channel:this._channel.channel_id},n=(new Date).toISOString().split(".")[0]+"Z",r=t.send_id,i=this._prepareProperties();return{occurred:n,user:e,send_id:r,body:{name:this.name,value:this.value,transaction:this.transactionId,interaction_id:this.interactionId,interaction_type:this.interactionType,template_type:this.templateType,session_id:t.id,properties:Object.keys(i).length?i:void 0}}},t.prototype.track=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,a.shouldReport(this._channel.opt_in)];case 1:return t.sent()?[4,this._prepareInteractionId()]:[2,{ok:!1,message:"Channel is not opted in or analytics/data-collection are disabled."}];case 2:return t.sent(),this.validate(),[4,s.default(o.default.paths.custom_events,{method:"post",body:this.toJSON()})];case 3:return[2,t.sent().json()]}}))}))},t}();e.default=d,Object.defineProperty(d,"templates",{value:{account:n(76).default,media:n(77).default,retail:n(78).default}})},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.shouldReport=e.getSession=e.sendSession=e.startSession=e.buttonClick=e.direct=void 0;var o=n(17),a=n(0),s=n(1),u=n(5),c=n(42),l=n(8),f=n(9),d=n(73);function h(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,v(t.optedIn)];case 1:if(!r.sent())return[2,!1];n={session_id:e.id,send_id:e.send_id,channel:t.toJSON()},l.default.setJSON("session",e),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,u.default(a.default.paths.reports.session,{method:"post",body:n})];case 3:return[2,r.sent().ok];case 4:return r.sent(),[2,!1];case 5:return[2]}}))}))}function p(){return r(this,void 0,void 0,(function(){var t,e,n;return i(this,(function(r){switch(r.label){case 0:return t=c.default("activity",.5),e=t.after,(0,t.store)(),[4,d.default()];case 1:return(n=r.sent())||e?[2,{id:o.v4(),send_id:n}]:[2]}}))}))}function v(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return a.default.disableAnalytics?[2,!1]:[4,s.default.get(a.default.consts.DISABLE_ANALYTICS)];case 1:return e.sent()?[2,!1]:t||a.default.trackEventsForOptOutChannels?[2,f.isDataCollectionEnabled()]:[2,!1]}}))}))}e.direct=function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return[4,v(t.optedIn)];case 1:return i.sent()?(n=a.default.paths.reports.direct,r={channel:t.toJSON(),send_id:e},[2,u.default(n,{method:"post",body:r})]):[2,!1]}}))}))},e.buttonClick=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return[4,v(t.optedIn)];case 1:return i.sent()?(r=a.default.paths.reports.customEvent,o={occurred:new Date(Date.now()).toISOString().split(".")[0],user:{web_channel:t.id},send_id:e,body:{name:"button--"+n.toLowerCase(),interaction_type:"ua_interactive_notification"}},[2,u.default(r,{method:"post",body:o})]):[2,!1]}}))}))},e.startSession=function(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return e?[2,h(t,e)]:[4,p()];case 1:return(n=r.sent())?[2,h(t,n)]:[2,!1]}}))}))},e.sendSession=h,e.getSession=p,e.shouldReport=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6);e.default=function(){var t=window.isSecureContext;return void 0!==t?t:Boolean(r.default().protocol.match("https"))}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},u=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),l=n(0),f=n(12),d=n(13),h=n(9),p=n(23),v=n(1),y=n(5),b=n(24),g=n(8),_=n(61),m=n(62),w=n(64),S=n(40),P=n(27),M=function(t){function e(e,n){var r=t.call(this)||this;return r.opt_in=!0,r.namedUserChanges=0,r._contact=e,r.channel_id=n.channel_id,r._named_user_id=null,r._tags=S.default({storeName:"tags"},(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r._applyTags.apply(r,u([],s(t)))}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r._validateTagGroup.apply(r,u([],s(t)))})),r._attributes=new _.default((function(){return{channel:r.channel_id}})),r._namedUser=new m.default({getName:function(){return r._named_user_id},setName:function(t){r.set({named_user_id:t})},getChannelId:function(){return r.channel_id},getContact:function(){return r._contact()}}),r.set(n),r}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.channel_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optedIn",{get:function(){return P._convertOptInStorageValue(this.opt_in)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"named_user_id",{get:function(){return console.warn("accessing the `named_user_id` of a channel may return a non-canonical response. its use is deprecated."),this._named_user_id},enumerable:!1,configurable:!0}),e.prototype._createSubscriptionManager=function(){var t=this,e=new p.CacheStorageManager({prefix:l.default.storagePrefix,ttlMs:l.default.subscriptionLists.cacheTtlMs},self.sessionStorage),n=new p.StorageGetCache(e),r=new p.ArrayCache({indexKey:"channel",keyFn:function(t){return t.listId}},e),i=P.CachingChannelSubscriptionListClient.createClient({paths:l.default.paths.subscription_lists},b.createRequest(l.default),n,r);return new w.default(i,(function(){return o(t,void 0,void 0,(function(){return a(this,(function(t){return[2,this.channel_id]}))}))}),(function(){return h.isDataCollectionEnabled()}))},Object.defineProperty(e.prototype,"subscriptions",{get:function(){return this._subscriptions||(this._subscriptions=this._createSubscriptionManager()),this._subscriptions},enumerable:!1,configurable:!0}),e.fromStorage=function(t){return o(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return[4,v.default.get("channel")];case 1:return(n=r.sent())?[2,new e(t,n)]:[2]}}))}))},e.prototype.optOut=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.set({opt_in:!1})];case 1:return t.sent(),[2,this.update(!1)]}}))}))},Object.defineProperty(e.prototype,"namedUser",{get:function(){return this._namedUser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return l.default.paths.cra+"/"+this.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),e.prototype._setLocaleOverride=function(t){this.localeOverride=t},e.prototype.toJSON=function(){return Object.assign(d.default({optedIn:this.optedIn,localeOverride:this.localeOverride}),{channel_id:this.id,opt_in:this.optedIn})},e.prototype._set=function(t){return console.warn("Channel._set() is deprecated and will be removed in the future. Please use Channel.set() instead."),this.set(t)},e.prototype.set=function(t){var e=Object.keys(t).every((function(t){return"named_user_id"===t}));return e&&this.namedUserChanges++,t.channel_id&&(this.channel_id=t.channel_id),void 0!==t.opt_in?this.opt_in=t.opt_in:this.opt_in=!0,void 0!==t.named_user_id&&(this._named_user_id=t.named_user_id),this._store(e)},e.prototype._store=function(t){return o(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(o){switch(o.label){case 0:return[4,h.isDataCollectionEnabled()];case 1:if(!o.sent())return console.warn("Data collection is disabled. Skipping channel storage."),[2,!1];e={channel_id:this.id,opt_in:this.optedIn,named_user_id:this._named_user_id},g.default.setJSON("channel",e),o.label=2;case 2:return o.trys.push([2,6,,7]),this.localeOverride?[3,4]:(n=this,[4,f.default.fromStorage()]);case 3:n.localeOverride=o.sent(),o.label=4;case 4:return[4,v.default.set("channel",e)];case 5:return o.sent(),t&&this.namedUserChanges>10?(console.error("Airship SDK: Maximum named user changes reached"),[2,!1]):(r=new CustomEvent("channel",{detail:this}),this.dispatchEvent(r),[2,!0]);case 6:return i=o.sent(),console.error("Airship SDK: Error while storing channel",i),[2,!1];case 7:return[2]}}))}))},e.prototype._update=function(t){return void 0===t&&(t=!0),console.warn("Channel._update() is deprecated and will be removed in the future. Please use Channel.update() instead."),this.update(t)},e.prototype.update=function(t){return void 0===t&&(t=!0),o(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return e=this.toJSON(),t&&delete e.opt_in,[4,h.isDataCollectionEnabled()];case 1:if(!r.sent())return console.warn("Data collection is disabled. Skipping channel update."),[2,!1];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,y.default(this.path,{method:"put",body:{channel:e}})];case 3:return r.sent(),[2,!0];case 4:return n=r.sent(),console.error("Airship SDK: Error while updating channel",n),[2,!1];case 5:return[2]}}))}))},e.prototype._applyTags=function(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:(i={audience:{web_channel:this.channel_id}})[t]=((o={})[n]=e,o),r=i,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,y.default(l.default.paths.tags,{method:"post",body:r})];case 2:return[2,a.sent().ok];case 3:return a.sent(),[2,!1];case 4:return[2]}}))}))},e.prototype._validateTagGroup=function(t){return t||"device"},e}(c.EventTarget);e.default=M},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayCache=e.StorageGetCache=e.CacheStorageManager=e.CACHE_MISS=void 0,e.CACHE_MISS=Object();var s=function(){function t(t,e){var n=t.ttlMs,r=t.prefix,i=t._getNow;this._ttlMs=n,this._prefix=r,this._getNow=null!=i?i:function(){return Date.now()},this._storage=e}return t.prototype.load=function(t){var n,r=this._makeKey(t),i=this._storage.getItem(r);if(!i)return e.CACHE_MISS;try{n=JSON.parse(i)}catch(t){return this._storage.removeItem(r),e.CACHE_MISS}return this._getNow()>n.expires?(this._storage.removeItem(r),e.CACHE_MISS):n.data},t.prototype.store=function(t,e){var n={expires:this._getNow()+this._ttlMs,data:e};this._storage.setItem(this._makeKey(t),JSON.stringify(n))},t.prototype.invalidate=function(t){this._storage.removeItem(this._makeKey(t))},t.prototype._makeKey=function(t){return this._prefix+":"+t},t}();e.CacheStorageManager=s;var u=function(){function t(t){this._storageManager=t}return t.prototype.get=function(t,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return(r=this._storageManager.load(t))!=e.CACHE_MISS?[2,r]:[4,n()];case 1:return o=i.sent(),this._storageManager.store(t,o),[2,o]}}))}))},t.prototype.invalidate=function(t){this._storageManager.invalidate(t)},t}();e.StorageGetCache=u;var c=function(){function t(t,e){var n=t.keyFn,r=t.indexKey;this._storageManager=e,this._indexKey=r,this._keyFn=n}return t.prototype.values=function(){var t=this,n=[],r=this._storageManager.load(this._indexKey);return r===e.CACHE_MISS?[]:(r.forEach((function(i){var o=t._storageManager.load(i);o===e.CACHE_MISS?t._storageManager.store(t._indexKey,r.filter((function(t){return t!==i}))):n.push(o)})),n)},t.prototype.push=function(t){var e=this._keyFn(t);this._pushToIndex(e),this._storageManager.store(e,t)},t.prototype._pushToIndex=function(t){var n=this._storageManager.load(this._indexKey);if(n!==e.CACHE_MISS){var r=n.filter((function(e){return e!==t}));this._storageManager.store(this._indexKey,a(a([],o(r)),[t]))}else this._storageManager.store(this._indexKey,[t])},t}();e.ArrayCache=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createRequest=void 0;var r=n(58);e.createRequest=function(t){if(t.appKey&&t.token)return new r.default({apiBase:t.apiUrl,appKey:t.appKey,type:"bearer",token:t.token});if(t.appKey&&t.secret)return new r.default({apiBase:t.apiUrl,appKey:t.appKey,type:"basic",secret:t.secret});throw new Error("invalid auth configuration: appKey and at least one of token or secret must be configured.")}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.groupListsById=e.LegacyAttributeBridge=e.validateNamedUserId=e.serializeTagMutations=e.serializeAttributeMutations=void 0;var s=n(18),u=n(39),c=n(26);function l(t){switch(t.action){case"set":return{action:s.AttributeAction.SET,key:t.key,value:u.serializeAttributeValue(t.value),timestamp:t.timestamp};case"remove":return{action:s.AttributeAction.REMOVE,key:t.key,timestamp:t.timestamp};default:throw new Error("invalid attribute mutation action: "+t)}}function f(t){var e={};return Object.keys(t).forEach((function(n){var r=a([],o(t[n].values()));r.length&&(e[n]=r)})),Object.keys(e).length?e:void 0}e.serializeAttributeMutations=function(t){var e=[];return a([],o(t)).reverse().filter((function(t){return!e.includes(t.key)&&(e.push(t.key),!0)})).map(l).reverse()},e.serializeTagMutations=function(t){var e={},n={},r={};return t.forEach((function(t){switch(t.action){case"add":return e[t.group]||(e[t.group]=new Set),void t.tags.forEach((function(r){e[t.group].add(r),n[t.group]&&n[t.group].delete(r)}));case"remove":return n[t.group]||(n[t.group]=new Set),void t.tags.forEach((function(r){n[t.group].add(r),e[t.group]&&e[t.group].delete(r)}));case"set":return r[t.group]||(r[t.group]=new Set),delete e[t.group],delete n[t.group],void t.tags.forEach((function(e){return r[t.group].add(e)}));default:throw new Error("invalid tag mutation action: "+t)}})),{add:f(e),remove:f(n),set:f(r)}},e.validateNamedUserId=function(t){if("string"!=typeof t)throw new c.InvalidNameError("must be a string");if(!t.trim())throw new c.InvalidNameError("must not be blank")};var d=function(){function t(t){this._attributeEditor=t}return t.prototype.set=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this._attributeEditor()];case 1:e=n.sent(),Object.entries(t).forEach((function(t){var n=o(t,2),r=n[0],i=n[1];return e.set(r,i)})),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.apply()];case 3:return n.sent(),[2,!0];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this._attributeEditor()];case 1:e=n.sent(),t.forEach((function(t){return e.remove(t)})),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.apply()];case 3:return n.sent(),[2,!0];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))},t}();e.LegacyAttributeBridge=d,e.groupListsById=function(t){var e={};return t.forEach((function(t){var n=t.scope;t.list_ids.forEach((function(t){e[t]?e[t].push(n):e[t]=[n]}))})),e}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidTagGroupError=e.InvalidNameError=e.ChannelNotPresentError=void 0;var o=function(t){function e(n){void 0===n&&(n="Cannot perform this operation without an associated channel.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error);e.ChannelNotPresentError=o;var a=function(t){function e(n){void 0===n&&(n="The provided name is not valid.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error);e.InvalidNameError=a;var s=function(t){function e(n){void 0===n&&(n="Invalid tag group.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error);e.InvalidTagGroupError=s},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.CachingChannelSubscriptionListClient=e.ChannelSubscriptionListClient=e._convertOptInStorageValue=void 0;var o=n(28);e._convertOptInStorageValue=function(t,e){var n=(void 0===e?{}:e).defaultValue,r=void 0===n||n;if("boolean"==typeof t)return t;if(void 0===t)return r;try{return JSON.parse(t)}catch(t){return r}};var a=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.listSubscriptions=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return e=this._config.paths.list+"/"+t,[4,this._request.get(e)];case 1:if(!(n=r.sent()).ok)throw new Error("unexpected response");return[2,n.list_ids]}}))}))},t.prototype.updateSubscriptions=function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return e.length?(n=this._config.paths.update,r={subscription_lists:o.serializeSubscriptionListMutations(e),audience:{web_channel:t}},[4,this._request.post(n,r)]):[2];case 1:return i.sent(),[2]}}))}))},t}();e.ChannelSubscriptionListClient=a;var s=function(){function t(t,e,n){this._client=t,this._cache=e,this._mutationCache=n}return t.prototype.updateSubscriptions=function(t,e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return[4,this._client.updateSubscriptions(t,e)];case 1:return r.sent(),e.forEach((function(t){return n._mutationCache.push(t)})),this._cache.invalidate(this._listKey(t)),[2]}}))}))},t.prototype.listSubscriptions=function(t){return r(this,void 0,void 0,(function(){var e,n,r=this;return i(this,(function(i){switch(i.label){case 0:return[4,this._cache.get(this._listKey(t),(function(){return r._client.listSubscriptions(t)}))];case 1:return e=i.sent(),n=this._mutationCache.values(),[2,o.updateIdentifierFromMutations(e,n)]}}))}))},t.prototype._listKey=function(t){return t+":subscription_lists"},t.createClient=function(e,n,r,i){return new t(new a(e,n),r,i)},t}();e.CachingChannelSubscriptionListClient=s},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function a(t){var e=[];return t.reverse().filter((function(t){return!e.includes(t.listId)&&(e.push(t.listId),!0)})).reverse()}function s(t){var e=[];return o([],i(t)).reverse().filter((function(t){return!e.find((function(e){return e.listId===t.listId&&e.scope===t.scope}))&&(e.push(t),!0)})).reverse()}function u(t){return{action:t.action,list_id:t.listId,timestamp:t.timestamp}}function c(t){return{action:t.action,list_id:t.listId,timestamp:t.timestamp,scope:t.scope}}Object.defineProperty(e,"__esModule",{value:!0}),e.updateScopedIdentifierFromMutations=e.serializeScopedSubscriptionListMutations=e.flattenScopedSubscriptionListMutations=e.updateIdentifierFromMutations=e.serializeSubscriptionListMutations=e.flattenSubscriptionListMutations=void 0,e.flattenSubscriptionListMutations=a,e.serializeSubscriptionListMutations=function(t){return a(t).map(u)},e.updateIdentifierFromMutations=function(t,e){var n=a(e),r=o([],i(t));return n.forEach((function(t){var e=t.action,n=t.listId;"subscribe"!==e||r.includes(n)||r.push(n),"unsubscribe"===e&&r.includes(n)&&(r=r.filter((function(t){return t!==n})))})),r},e.flattenScopedSubscriptionListMutations=s,e.serializeScopedSubscriptionListMutations=function(t){return s(t).map(c)},e.updateScopedIdentifierFromMutations=function(t,e){var n=r({},t);return s(e).forEach((function(t){var e=t.listId,r=t.scope,i=t.action;n[e]||(n[e]=[]),"subscribe"!==i||n[e].includes(r)||n[e].push(r),"unsubscribe"===i&&n[e].includes(r)&&(n[e]=n[e].filter((function(t){return t!==r}))),n[e].length||delete n[e]})),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(79);e.default=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e=!1),r.default.configured)return r.default;delete t.paths,delete t.consts,Object.assign(r.default,t);var n=new URL(r.default.workerUrl,r.default.workerUrl.startsWith("/")?self.location.href:void 0);r.default.deprecatedStoragePrefix=self.btoa(r.default.storagePrefix+":"+r.default.appKey+":"+r.default.workerUrl);var o=n.pathname.replace(/[^/]+$/,"");if(r.default.storagePrefix=self.btoa(r.default.storagePrefix+":"+r.default.appKey+":"+o),r.default.secureBridgeUrl=i.default(r.default),r.default.registrationDomain?r.default.secureHost="https://"+r.default.registrationDomain:r.default.secureBridgeUrl&&(r.default.secureHost=new URL(r.default.secureBridgeUrl).origin),r.default.debug){var a=e?"secure-bridge":"main";console.log("UA[%s] configured with:",a,r.default)}return r.default.contacts.namedUserTtlMs=Math.max(36e5,r.default.contacts.namedUserTtlMs),r.default.configured=!0,r.default}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return e.push_address=t.endpoint,e.web.subscription=t.toJSON().keys,{channel:e}}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),a=n(87),s=n(88);function u(t,e){return t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})}e.default=function(t){return r(this,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:return"string"!=typeof(e=o.default.vapidPublicKey)?[2,Promise.reject("vapidPublicKey not configured")]:(n=a.default(e),[4,t.pushManager.getSubscription()]);case 1:return(r=i.sent())?s.default(new Uint8Array(r.options.applicationServerKey),n)?[2,r]:[4,r.unsubscribe()]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2,u(t,n)]}}))}))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),a=n(27),s=function(){function t(t){var e;this._channelId=t.channelId,this._namedUserId=null!==(e=t.namedUserId)&&void 0!==e?e:null,this._optedIn=t.optedIn,this._localeOverride=t.localeOverride}return Object.defineProperty(t.prototype,"id",{get:function(){return this._channelId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"named_user_id",{get:function(){return console.warn("accessing the `named_user_id` of a channel may return a non-canonical response. its use is deprecated."),this._namedUserId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optedIn",{get:function(){return this._optedIn},enumerable:!1,configurable:!0}),t.fromStorage=function(e,n){var o;return r(this,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return[4,e.get("channel")];case 1:return(r=i.sent())?[4,n()]:[3,3];case 2:return s=i.sent(),[2,new t({channelId:r.channel_id,namedUserId:null!==(o=r.named_user_id)&&void 0!==o?o:void 0,optedIn:a._convertOptInStorageValue(r.opt_in),localeOverride:s})];case 3:return[2]}}))}))},t.prototype.toJSON=function(){return Object.assign(o.default({optedIn:this.optedIn,localeOverride:this._localeOverride}),{channel_id:this.id,opt_in:this.optedIn})},t}();e.default=s},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this._acquired=!1,this._waitingResolvers=[]}get acquired(){return this._acquired}acquireAsync(){return this._acquired?new Promise((t=>{this._waitingResolvers.push(t)})):(this._acquired=!0,Promise.resolve())}tryAcquire(){return!this._acquired&&(this._acquired=!0,!0)}release(){if(!this._acquired)throw new Error("Cannot release an unacquired lock");if(this._waitingResolvers.length>0){this._waitingResolvers.shift()()}else this._acquired=!1}}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o,a=n(3);try{o=window}catch(t){o=self}e.default=function(t,e,n,s,u){var c;function l(){return c||(c=new Promise((function(r,i){var s=o.indexedDB.open(t(),u);s.addEventListener("upgradeneeded",(function(t){var r=t.target.result;try{r.createObjectStore(e,n)}catch(t){a.default('Error when "upgrading" indexedDB',t)}})),s.addEventListener("success",(function(){return r(s.result)})),s.addEventListener("error",(function(t){return i(t)}))})))}function f(t,n){void 0===n&&(n=!1);var r=n?"readwrite":"readonly";return t.transaction([e],r).objectStore(e)}function d(t,e,n){return void 0===e&&(e=function(t){return t.target.result}),void 0===n&&(n=function(t){return t.target.error}),new Promise((function(r,i){t.addEventListener("success",(function(t){r(e(t))})),t.addEventListener("error",(function(t){return i(n(t))}))}))}function h(){return l().then((function(t){return d(f(t).getAll())}))}return{getDB:l,getObjectStore:f,requestToPromise:d,get:function(t){return l().then((function(e){return d(f(e).get(t),(function(t){if(void 0!==t.target.result)return s(t)}))}))},getAll:h,set:function(t,e){return l().then((function(r){return n.keyPath?d(f(r,!0).put({type:t,value:e})):d(f(r,!0).put(e,t))}))},count:function(){return a.default("Db.count(): counting db %s",t()),l().then((function(t){return d(f(t).count())}))},remove:function(t){return l().then((function(e){return d(f(e,!0).delete(t))}))},copy:function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,t.count()];case 1:return r.sent()?[2,!1]:[4,h()];case 2:return(null==(e=r.sent())?void 0:e.length)?(a.default("Db.copy(): coppying db"),n=e.map((function(e){return t.set(e.type,e.value)})),[4,Promise.all(n)]):[3,4];case 3:return r.sent(),[2,!0];case 4:return[2,!1]}}))}))}}}},function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=90)}({17:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r=n(18),i=function(){function t(){}return t.getFirstMatch=function(t,e){var n=e.match(t);return n&&n.length>0&&n[1]||""},t.getSecondMatch=function(t,e){var n=e.match(t);return n&&n.length>1&&n[2]||""},t.matchAndReturnConst=function(t,e,n){if(t.test(e))return n},t.getWindowsVersionName=function(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},t.getMacOSVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),10===e[0])switch(e[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},t.getAndroidVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),!(1===e[0]&&e[1]<5))return 1===e[0]&&e[1]<6?"Cupcake":1===e[0]&&e[1]>=6?"Donut":2===e[0]&&e[1]<2?"Eclair":2===e[0]&&2===e[1]?"Froyo":2===e[0]&&e[1]>2?"Gingerbread":3===e[0]?"Honeycomb":4===e[0]&&e[1]<1?"Ice Cream Sandwich":4===e[0]&&e[1]<4?"Jelly Bean":4===e[0]&&e[1]>=4?"KitKat":5===e[0]?"Lollipop":6===e[0]?"Marshmallow":7===e[0]?"Nougat":8===e[0]?"Oreo":9===e[0]?"Pie":void 0},t.getVersionPrecision=function(t){return t.split(".").length},t.compareVersions=function(e,n,r){void 0===r&&(r=!1);var i=t.getVersionPrecision(e),o=t.getVersionPrecision(n),a=Math.max(i,o),s=0,u=t.map([e,n],(function(e){var n=a-t.getVersionPrecision(e),r=e+new Array(n+1).join(".0");return t.map(r.split("."),(function(t){return new Array(20-t.length).join("0")+t})).reverse()}));for(r&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===s)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},t.map=function(t,e){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(n=0;n<t.length;n+=1)r.push(e(t[n]));return r},t.find=function(t,e){var n,r;if(Array.prototype.find)return Array.prototype.find.call(t,e);for(n=0,r=t.length;n<r;n+=1){var i=t[n];if(e(i,n))return i}},t.assign=function(t){for(var e,n,r=t,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[t].concat(o));var s=function(){var t=o[e];"object"==typeof t&&null!==t&&Object.keys(t).forEach((function(e){r[e]=t[e]}))};for(e=0,n=o.length;e<n;e+=1)s();return t},t.getBrowserAlias=function(t){return r.BROWSER_ALIASES_MAP[t]},t.getBrowserTypeByAlias=function(t){return r.BROWSER_MAP[t]||""},t}();e.default=i,t.exports=e.default},18:function(t,e,n){"use strict";e.__esModule=!0,e.ENGINE_MAP=e.OS_MAP=e.PLATFORMS_MAP=e.BROWSER_MAP=e.BROWSER_ALIASES_MAP=void 0,e.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},e.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},e.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},e.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(){}var e,n;return t.getParser=function(t,e){if(void 0===e&&(e=!1),"string"!=typeof t)throw new Error("UserAgent should be a string");return new i.default(t,e)},t.parse=function(t){return new i.default(t).getResult()},e=t,(n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&a(e,n),t}();e.default=s,t.exports=e.default},91:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r=u(n(92)),i=u(n(93)),o=u(n(94)),a=u(n(95)),s=u(n(17));function u(t){return t&&t.__esModule?t:{default:t}}var c=function(){function t(t,e){if(void 0===e&&(e=!1),null==t||""===t)throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},!0!==e&&this.parse()}var e=t.prototype;return e.getUA=function(){return this._ua},e.test=function(t){return t.test(this._ua)},e.parseBrowser=function(){var t=this;this.parsedResult.browser={};var e=s.default.find(r.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser},e.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},e.getBrowserName=function(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},e.getBrowserVersion=function(){return this.getBrowser().version},e.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},e.parseOS=function(){var t=this;this.parsedResult.os={};var e=s.default.find(i.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os},e.getOSName=function(t){var e=this.getOS().name;return t?String(e).toLowerCase()||"":e||""},e.getOSVersion=function(){return this.getOS().version},e.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},e.getPlatformType=function(t){void 0===t&&(t=!1);var e=this.getPlatform().type;return t?String(e).toLowerCase()||"":e||""},e.parsePlatform=function(){var t=this;this.parsedResult.platform={};var e=s.default.find(o.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform},e.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},e.getEngineName=function(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},e.parseEngine=function(){var t=this;this.parsedResult.engine={};var e=s.default.find(a.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine},e.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},e.getResult=function(){return s.default.assign({},this.parsedResult)},e.satisfies=function(t){var e=this,n={},r=0,i={},o=0;if(Object.keys(t).forEach((function(e){var a=t[e];"string"==typeof a?(i[e]=a,o+=1):"object"==typeof a&&(n[e]=a,r+=1)})),r>0){var a=Object.keys(n),u=s.default.find(a,(function(t){return e.isOS(t)}));if(u){var c=this.satisfies(n[u]);if(void 0!==c)return c}var l=s.default.find(a,(function(t){return e.isPlatform(t)}));if(l){var f=this.satisfies(n[l]);if(void 0!==f)return f}}if(o>0){var d=Object.keys(i),h=s.default.find(d,(function(t){return e.isBrowser(t,!0)}));if(void 0!==h)return this.compareVersion(i[h])}},e.isBrowser=function(t,e){void 0===e&&(e=!1);var n=this.getBrowserName().toLowerCase(),r=t.toLowerCase(),i=s.default.getBrowserTypeByAlias(r);return e&&i&&(r=i.toLowerCase()),r===n},e.compareVersion=function(t){var e=[0],n=t,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===t[0]||"<"===t[0]?(n=t.substr(1),"="===t[1]?(r=!0,n=t.substr(2)):e=[],">"===t[0]?e.push(1):e.push(-1)):"="===t[0]?n=t.substr(1):"~"===t[0]&&(r=!0,n=t.substr(1)),e.indexOf(s.default.compareVersions(i,n,r))>-1},e.isOS=function(t){return this.getOSName(!0)===String(t).toLowerCase()},e.isPlatform=function(t){return this.getPlatformType(!0)===String(t).toLowerCase()},e.isEngine=function(t){return this.getEngineName(!0)===String(t).toLowerCase()},e.is=function(t){return this.isBrowser(t)||this.isOS(t)||this.isPlatform(t)},e.some=function(t){var e=this;return void 0===t&&(t=[]),t.some((function(t){return e.is(t)}))},t}();e.default=c,t.exports=e.default},92:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(t){var e={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/opera/i],describe:function(t){var e={name:"Opera"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe:function(t){var e={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe:function(t){var e={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe:function(t){var e={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe:function(t){var e={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/focus/i],describe:function(t){var e={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/swing/i],describe:function(t){var e={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/coast/i],describe:function(t){var e={name:"Opera Coast"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe:function(t){var e={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe:function(t){var e={name:"UC Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe:function(t){var e={name:"Maxthon"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe:function(t){var e={name:"Epiphany"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe:function(t){var e={name:"Puffin"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe:function(t){var e={name:"Sleipnir"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe:function(t){var e={name:"K-Meleon"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe:function(t){var e={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe:function(t){var e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe:function(t){var e={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe:function(t){var e={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe:function(t){var e={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe:function(t){var e={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe:function(t){var e={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe:function(t){var e={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe:function(t){var e={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe:function(t){var e={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe:function(t){var e={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e={name:"BlackBerry"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e={name:"WebOS Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe:function(t){var e={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe:function(t){var e={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe:function(t){var e={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe:function(t){var e={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe:function(t){var e={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe:function(t){var e={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe:function(t){var e={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe:function(t){var e={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){var e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe:function(t){var e={name:"Android Browser"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe:function(t){var e={name:"PlayStation 4"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe:function(t){var e={name:"Safari"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/.*/i],describe:function(t){var e=-1!==t.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(e,t),version:i.default.getSecondMatch(e,t)}}}];e.default=a,t.exports=e.default},93:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(t){var e=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:o.OS_MAP.Roku,version:e}}},{test:[/windows phone/i],describe:function(t){var e=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.WindowsPhone,version:e}}},{test:[/windows /i],describe:function(t){var e=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=i.default.getWindowsVersionName(e);return{name:o.OS_MAP.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(t){var e=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return{name:o.OS_MAP.iOS,version:e}}},{test:[/macintosh/i],describe:function(t){var e=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(e),r={name:o.OS_MAP.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(t){var e=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:e}}},{test:function(t){var e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe:function(t){var e=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=i.default.getAndroidVersionName(e),r={name:o.OS_MAP.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:o.OS_MAP.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||i.default.getFirstMatch(/\bbb(\d+)/i,t);return{name:o.OS_MAP.BlackBerry,version:e}}},{test:[/bada/i],describe:function(t){var e=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.Bada,version:e}}},{test:[/tizen/i],describe:function(t){var e=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.Tizen,version:e}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(t){var e=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.PlayStation4,version:e}}}];e.default=a,t.exports=e.default},94:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(t){var e=i.default.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(t){var e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe:function(t){var e=i.default.getFirstMatch(/(ipod|iphone)/i,t);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"blackberry"===t.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(t){return"bada"===t.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"windows phone"===t.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(t){var e=Number(String(t.getOSVersion()).split(".")[0]);return"android"===t.getOSName(!0)&&e>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(t){return"android"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"macos"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(t){return"windows"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(t){return"linux"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(t){return"playstation 4"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(t){return"roku"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];e.default=a,t.exports=e.default},95:function(t,e,n){"use strict";e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:function(t){return"microsoft edge"===t.getBrowserName(!0)},describe:function(t){if(/\sedg\//i.test(t))return{name:o.ENGINE_MAP.Blink};var e=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:o.ENGINE_MAP.EdgeHTML,version:e}}},{test:[/trident/i],describe:function(t){var e={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){return t.test(/presto/i)},describe:function(t){var e={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){var e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe:function(t){var e={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(t){var e={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];e.default=a,t.exports=e.default}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.maybeArrayify=void 0,e.default=function(t){return Array.isArray(t)?t:[t]},e.maybeArrayify=function(t){return void 0===t||Array.isArray(t)?t:[t]}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.serializeAttributeValue=e.InvalidAttributeValueError=void 0;var o=n(10),a=function(t){function e(n){void 0===n&&(n="The provided name is not valid.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error);e.InvalidAttributeValueError=a,e.serializeAttributeValue=function(t){if("string"==typeof t)return t;if("number"==typeof t)return t.toString(10);if(t instanceof Date)return o.apiTimestamp(t);throw new a("invalid attribute value")}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),l=n(9),f=n(3),d=n(8),h=n(18),p=function(t){function e(e){var n=t.call(this)||this;return n.storeName=e,n._tagList={},n.tagMap=new Map,n._load(),n}return i(e,t),e.prototype.has=function(t,e){void 0===e&&(e="device"),console.warn("Tags.has() is deprecated, and will be removed in a future version.");var n=this.tagMap.get(e);return!!n&&n.has(t)},e.prototype.add=function(t,e){var n;return void 0===e&&(e=""),o(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,l.isDataCollectionEnabled()];case 1:return r.sent()?(e=this._validateGroup(e),this.has(t,e)?[2,!0]:(this.tagMap.has(e)?null===(n=this.tagMap.get(e))||void 0===n||n.add(t):this.tagMap.set(e,new Set([t])),[2,this._send(h.TagAction.ADD,[t],e)])):(console.warn("Data collection is disabled. Adding tags is not allowed."),[2,!1])}}))}))},e.prototype.remove=function(t,e){var n;return void 0===e&&(e=""),o(this,void 0,void 0,(function(){return a(this,(function(r){return e=this._validateGroup(e),this.has(t,e)?(null===(n=this.tagMap.get(e))||void 0===n||n.delete(t),[2,this._send(h.TagAction.REMOVE,[t],e)]):[2,!0]}))}))},e.prototype.clear=function(){this.tagMap=new Map,this.set([],"device")},e.prototype.set=function(t,e){return void 0===e&&(e=""),o(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,l.isDataCollectionEnabled()];case 1:return!n.sent()&&t.length?(console.warn("Data collection is disabled. Setting tags is not allowed."),[2,!1]):(e=this._validateGroup(e),this.tagMap.set(e,new Set(t)),[2,this._send(h.TagAction.SET,t,e)])}}))}))},Object.defineProperty(e.prototype,"list",{get:function(){var t,e;console.warn("Tags.list is deprecated, and will be removed in a future version.");var n={};try{for(var r=s(this.tagMap),i=r.next();!i.done;i=r.next()){var o=u(i.value,2),a=o[0],c=o[1];c.size&&(n[a]=Array.from(c))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),e.prototype._load=function(t){var e,n;void 0===t&&(t=d.default.getJSON(this.storeName));var r=new Map;try{if(t)try{for(var i=s(Object.keys(t)),o=i.next();!o.done;o=i.next()){var a=o.value;r.set(a,new Set(t[a]))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}catch(t){f.default("Error loading tags:",t)}return this.tagMap=r,this.tagMap},e.prototype._send=function(t,e,n){return o(this,void 0,void 0,(function(){return a(this,(function(r){return this._store(),[2,this._apply(t,e,n)]}))}))},e.prototype.sync=function(t){this._load(t),this._store()},e.prototype._store=function(){var t=this.list;if(t!==this._tagList){d.default.setJSON("tags",t),this._tagList=t;var e=new CustomEvent("tags",{detail:t});this.dispatchEvent(e)}},e}(c.EventTarget);e.default=function(t,e,n){var r=t.storeName;return new(function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype._apply=function(t,n,r){return e(t,n,r)},r.prototype._validateGroup=function(t){return n(t)},r}(p))(r)}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.makeContact=void 0;var c=n(35),l=n(2),f=n(11),d=n(65),h=n(1),p=n(3),v=n(4),y=n(24),b=n(28),g=n(66),_=n(67),m=n(26),w=n(68),S=n(70),P=n(71),M=n(72),O=n(25),E=function(t){function e(e,n,r,i,o,a,s){var u,l=t.call(this)||this;return l._channel=e,l._locale=n,l._storage=r,l._client=i,l._registration=o,l._flags=a,l._emitter=s,l._mutex=new c.default,l._ready=l._init(),null===(u=l._emitter)||void 0===u||u.addEventListener("channel",(function(t){return l._onChannel(t)})),l}return i(e,t),e.prototype._init=function(){return a(this,void 0,void 0,(function(){var t,e,n,r;return s(this,(function(i){switch(i.label){case 0:return[4,this._channel()];case 1:return t=i.sent(),[4,this._storage.getNamedUserId()];case 2:return e=i.sent(),t?[4,this._migrate(t,e)]:(p.default("contact: initialized without channel"),[2]);case 3:return i.sent()?(p.default("contact: successful migration"),[2]):[4,this._resolve(t.id)];case 4:return n=u.apply(void 0,[i.sent(),1]),r=n[0],[4,this._applyPendingAttributeMutations(r)];case 5:return i.sent(),[4,this._applyPendingTagMutations(r)];case 6:return i.sent(),[4,this._applyPendingSubscriptionListMutations(r)];case 7:return i.sent(),p.default("contact: initialized"),[2]}}))}))},e.prototype.identify=function(t){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){switch(n.label){case 0:return[4,this._ready];case 1:return n.sent(),O.validateNamedUserId(t),[2,this._mutex.acquireAsync().then((function(){return e._identify(t)})).finally((function(){return e._mutex.release()}))]}}))}))},e.prototype._identify=function(t){return a(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,this._namedUserIdEquals(t)];case 1:return r.sent()?(p.default("contact: identify, not setting as user is already identified"),[2]):[4,this._storage.getNamedUserId()];case 2:return r.sent()?(p.default("contact: identify, this contact already has a named user. Creating new contact."),[4,this._storage.clearContactId()]):[3,5];case 3:return e=r.sent(),[4,this._resetStoredContact(e)];case 4:r.sent(),r.label=5;case 5:return[4,this._nonCanonicalChannelId()];case 6:if(!(n=r.sent()))throw new m.ChannelNotPresentError;return[4,this._doIdentify(t,n)];case 7:return r.sent(),p.default("contact: identified",t,n),[2]}}))}))},e.prototype._namedUserIdEquals=function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=t,[4,this._storage.getNamedUserId()];case 1:return[2,e===n.sent()]}}))}))},e.prototype.reset=function(){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){switch(e.label){case 0:return[4,this._ready];case 1:return e.sent(),[4,this._mutex.acquireAsync().then((function(){return t._reset()})).finally((function(){return t._mutex.release()}))];case 2:return e.sent(),[2]}}))}))},e.prototype._reset=function(){return a(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this._channel()];case 1:return t=e.sent(),[4,this._doReset(null==t?void 0:t.id)];case 2:return e.sent(),[2]}}))}))},e.prototype.editAttributes=function(){return a(this,void 0,void 0,(function(){var t,e,n=this;return s(this,(function(r){switch(r.label){case 0:return[4,this._ready];case 1:return r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return t=r.sent(),e=g.default,[4,this._storage.getPendingAttributeMutations()];case 3:return[2,e.apply(void 0,[r.sent(),function(e){return a(n,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._flags.isDataCollectionEnabled()];case 1:if(!n.sent())throw new f.DataCollectionDisabledError;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingAttributeMutations(e)];case 3:return n.sent(),[2];case 4:return[4,this._applyPendingAttributeMutations(t,e)];case 5:return n.sent(),[2]}}))}))}])]}}))}))},e.prototype._applyPendingAttributeMutations=function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingAttributeMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateAttributes(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingAttributeMutations([])];case 5:return i.sent(),[4,this._storage.appendAttributeMutations(t,n)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))},e.prototype.editTags=function(){return a(this,void 0,void 0,(function(){var t,e,n=this;return s(this,(function(r){switch(r.label){case 0:return[4,this._ready];case 1:return r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return t=r.sent(),e=M.default,[4,this._storage.getPendingTagMutations()];case 3:return[2,e.apply(void 0,[r.sent(),function(e){return a(n,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._flags.isDataCollectionEnabled()];case 1:if(!n.sent())throw new f.DataCollectionDisabledError;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingTagMutations(e)];case 3:return n.sent(),[2];case 4:return[4,this._applyPendingTagMutations(t,e)];case 5:return n.sent(),[2]}}))}))}])]}}))}))},e.prototype._applyPendingTagMutations=function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingTagMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateTags(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingTagMutations([])];case 5:return i.sent(),[4,this._storage.appendTagMutations(t,n)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))},e.prototype._createSubscriptionManager=function(){var t=this;return new P.default(this._client,this._storage,(function(){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this._ready];case 1:return t.sent(),[2,this._storage.getOrCreateContactId()]}}))}))}),(function(){return t._flags.isDataCollectionEnabled()}),(function(){return t._isRelevantToAirship()}))},Object.defineProperty(e.prototype,"subscriptions",{get:function(){return this._subscriptions||(this._subscriptions=this._createSubscriptionManager()),this._subscriptions},enumerable:!1,configurable:!0}),e.prototype._applyPendingSubscriptionListMutations=function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingSubscriptionListMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateSubscriptions(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingSubscriptionListMutations([])];case 5:return i.sent(),[4,this._storage.appendSubscriptionListMutations(t,n)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))},e.prototype._registerAndAssociateChannel=function(t){return a(this,void 0,void 0,(function(){var e,n,r;return s(this,(function(i){switch(i.label){case 0:return[4,this._ready];case 1:return i.sent(),n=v.getIntlDetails,[4,this._locale()];case 2:return e=n.apply(void 0,[i.sent()]),[4,t(e)];case 3:return r=i.sent(),[2,this._associateChannel(r)]}}))}))},e.prototype._associateChannel=function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return e=n.sent(),[4,this._client.associateChannel(e,t)];case 2:return n.sent(),[4,this._storage.appendAssociatedChannel(e,t)];case 3:return n.sent(),[4,this._applyPendingAttributeMutations(e)];case 4:return n.sent(),[4,this._applyPendingTagMutations(e)];case 5:return n.sent(),[4,this._applyPendingSubscriptionListMutations(e)];case 6:return n.sent(),[2]}}))}))},e.prototype.registerEmail=function(t,e){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return a(n,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerEmail(t,o(o({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"email"}]}}))}))}))]}))}))},e.prototype.registerSms=function(t,e){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return a(n,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerSms(t,o(o({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"sms"}]}}))}))}))]}))}))},e.prototype.registerOpen=function(t,e){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return a(n,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerOpen(t,o(o({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"open"}]}}))}))}))]}))}))},e.prototype.associateChannel=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._ready];case 1:if(n.sent(),!d.isPlatform(t))throw new f.ValidationError("invalid platform: "+t);return[2,this._associateChannel({platform:t,channelId:e})]}}))}))},e.prototype._migrate=function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return(n=null==t?void 0:t.named_user_id)?n===e?(p.default("contact: old nu matches new nu, no migration needed"),[2,!1]):[4,this._resolve(t.id,!0)]:(p.default("contact: no old nu, no migration needed"),[2,!1]);case 1:return r=u.apply(void 0,[i.sent(),2]),r[1]?(p.default("contact: migration for existing user resolved to anonymous"),[2,!1]):[4,this._storage.setNamedUserId(n)];case 2:return i.sent(),[2,!0]}}))}))},e.prototype._resolve=function(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,c,l;return s(this,(function(s){switch(s.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return n=s.sent(),[4,this._storage.getNamedUserId()];case 2:return r=s.sent(),(i=!e)?[4,this._storage.sessionResolved()]:[3,4];case 3:i=s.sent(),s.label=4;case 4:return i?[2,[n,!r]]:[4,this._client.resolve(t)];case 5:return o=u.apply(void 0,[s.sent(),2]),a=o[0],c=o[1],[4,this._storage.setSessionResolved(!0)];case 6:return s.sent(),l=!r===c,n===a&&l?[2,[a,c]]:[4,this._storage.setContactId(a)];case 7:return s.sent(),c?[4,this._storage.clearNamedUserId()]:[3,9];case 8:s.sent(),s.label=9;case 9:return[4,this._maybeEmitConflict(n,r)];case 10:return s.sent(),[2,[a,c]]}}))}))},e.prototype._doIdentify=function(t,e){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return n=i.sent(),[4,this._client.identify(t,e,{contactId:n})];case 2:return r=i.sent(),n===r?[3,4]:[4,this._maybeEmitConflict(n)];case 3:i.sent(),i.label=4;case 4:return[4,this._storage.setContactId(r)];case 5:return i.sent(),[4,this._storage.setNamedUserId(t)];case 6:return i.sent(),[4,this._storage.setSessionResolved(!0)];case 7:return i.sent(),[2]}}))}))},e.prototype._doReset=function(t){return a(this,void 0,void 0,(function(){var e,n,r,i;return s(this,(function(o){switch(o.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return e=o.sent(),t?[4,this._client.reset(t)]:[3,3];case 2:return n=o.sent(),[3,5];case 3:return[4,this._storage.clearContactId()];case 4:n=o.sent(),o.label=5;case 5:return e===n?[3,8]:(r=this._maybeEmitConflict,i=[e],[4,this._storage.getNamedUserId()]);case 6:return[4,r.apply(this,i.concat([o.sent()]))];case 7:o.sent(),o.label=8;case 8:return[4,this._resetStoredContact(n)];case 9:return o.sent(),[2]}}))}))},e.prototype._onChannel=function(t){return a(this,void 0,void 0,(function(){var e,n,r,i;return s(this,(function(o){switch(o.label){case 0:return[4,this._ready];case 1:return o.sent(),(e=t.detail)?[4,this._isRelevantToAirship()]:[2];case 2:return o.sent()?[4,this._resolve(e.id)]:[2];case 3:return n=u.apply(void 0,[o.sent(),1]),r=n[0],[4,this._applyPendingAttributeMutations(r)];case 4:return o.sent(),[4,this._applyPendingTagMutations(r)];case 5:return o.sent(),[4,this._applyPendingSubscriptionListMutations(r)];case 6:return o.sent(),i=new CustomEvent("_channel_handled"),this.dispatchEvent(i),[2]}}))}))},e.prototype._maybeEmitConflict=function(t,e){return a(this,void 0,void 0,(function(){var n,r,i,o,a,u;return s(this,(function(s){switch(s.label){case 0:return[4,this._storage.getAttributeMutations(t)];case 1:return n=s.sent(),[4,this._storage.getTagMutations(t)];case 2:return r=s.sent(),[4,this._storage.getAssociatedChannels(t)];case 3:return i=s.sent(),[4,this._storage.getSubscriptionListMutations(t)];case 4:return o=s.sent(),e||n.length||r.length||i.length||o.length?(a={namedUserId:e,attributes:O.serializeAttributeMutations(n),tags:O.serializeTagMutations(r),subscriptions:b.serializeSubscriptionListMutations(o),associatedChannels:i},u=new CustomEvent("conflict",{detail:a}),this.dispatchEvent(u),[2]):[2]}}))}))},Object.defineProperty(e.prototype,"ready",{get:function(){return this._ready},enumerable:!1,configurable:!0}),e.prototype._isRelevantToAirship=function(){return a(this,void 0,void 0,(function(){var t,e,n;return s(this,(function(r){switch(r.label){case 0:return[4,this._channel()];case 1:return t=r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return e=r.sent(),[4,this._storage.getAssociatedChannels(e)];case 3:return n=r.sent(),[2,!!t||!!n.length]}}))}))},e.prototype._nonCanonicalChannelId=function(){var t;return a(this,void 0,void 0,(function(){var e,n,r;return s(this,(function(i){switch(i.label){case 0:return[4,this._channel()];case 1:return(e=i.sent())?[2,e.id]:[4,this._storage.getOrCreateContactId()];case 2:return n=i.sent(),[4,this._storage.getAssociatedChannels(n)];case 3:return r=i.sent(),[2,null===(t=r[0])||void 0===t?void 0:t.channelId]}}))}))},e.prototype._resetStoredContact=function(t){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._storage.setContactId(t)];case 1:return e.sent(),[4,this._storage.clearNamedUserId()];case 2:return e.sent(),[4,this._storage.setPendingAttributeMutations([])];case 3:return e.sent(),[4,this._storage.setPendingTagMutations([])];case 4:return e.sent(),[2]}}))}))},e}(l.EventTarget);e.makeContact=function(t,e,n,r,i){var o=new S.default({prefix:t.storagePrefix,sessionLengthMs:t.contacts.sessionLengthMs,namedUserTtlMs:t.contacts.namedUserTtlMs,_forceExpireNamedUsers:t.contacts._forceExpireNamedUsers},h.default,self.sessionStorage),a=_.createContactClient({paths:t.paths.contact,storagePrefix:t.storagePrefix,cacheTtlMs:t.subscriptionLists.cacheTtlMs},y.createRequest(t)),s=new w.default({paths:t.paths.contact.registration},y.createRequest(t));return new E(e,n,o,a,s,r,i)},e.default=E},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8);e.default=function(t,e){t="last_"+t;var n=+new Date,i=r.default.getJSON(t);return{store:function(){return r.default.setJSON(t,n)},after:!i||n-i>36e5*e}}},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.setupIframe=e.onBridgeMessage=e.setupBridge=void 0;var i=n(0),o=n(29),a=n(20),s=n(1),u=n(3),c=n(6),l=n(8),f=n(80);function d(t){t.tags&&(u.default("[secure-bridge] Setting channel tags from message data: %o",t.tags),l.default.setJSON("tags",t.tags)),t.channel&&(u.default("[secure-bridge] Setting channel data from message data: %o",t.channel),s.default.set("channel",t.channel)),t.subscriptionDomain&&(u.default("[secure-bridge] Setting subscriptionDomain from message data: %s",t.subscriptionDomain),s.default.set("subscriptionDomain",t.subscriptionDomain))}e.setupBridge=function(t){if("https:"!==c.default().protocol)throw new Error("The secure bridge must be run on an HTTPS domain that is shared with the push registration page.");o.default(t,!0);var e=f.getTargetOrigin(t.allowedDomains);window.addEventListener("storage",l.default.onStorage(p)),window.addEventListener("message",f.debounceMessage(d,e));var n=s.default.get("subscriptionDomain"),i=s.default.get("channel"),h=l.default.getJSON("tags");return Promise.all([i,n]).then((function(t){var e=r(t,2),n=e[0],i=e[1];if(i&&u.default("[secure-bridge] Subscription domain found in secure-bridge: %s",i),p({channel:n,tags:h,subscriptionDomain:i}),n)return a.getSession().then((function(t){t&&(l.default.setJSON("session",t),p({session:t}))}))}));function p(t){window.parent.postMessage(f.prefixObject(t),e)}},e.onBridgeMessage=d,e.setupIframe=function(t,e){u.default("Setting up secure-bridge with %s",e);var n=i.default.secureHost,r=document.createElement("iframe"),o=new Promise((function(t){r.onload=function(){return t(r)}})),a=new URL(e);function l(t){o.then((function(e){var r;u.default("[main] Sending data to secure-bridge (%s): %o",n,t),null===(r=e.contentWindow)||void 0===r||r.postMessage(f.prefixObject(t),n)}))}a.searchParams.append("__ua_secondary_origin",c.default().origin),r.style.display="none",r.src=a.toString(),document.body.appendChild(r),window.addEventListener("message",(function(e){var r=f.getMessageDataFrom(e,n);t._set(r)})),t.addEventListener("tags",(function(t){l({tags:t.tags})})),t.addEventListener("channel",(function(){s.default.get("channel").then((function(t){l({channel:t})}))})),t.addEventListener("subscriptiondomain",(function(t){l({subscriptionDomain:t.detail})}))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.isPreferenceCenterPayload=void 0,e.isPreferenceCenterPayload=function(t){return"preference_forms"===t.type};var o=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.get=function(t){var e=t.locale;return r(this,void 0,void 0,(function(){var t,n,r,o,a,s,u;return i(this,(function(i){switch(i.label){case 0:return t=this._config,n=t.paths,r=t.sdkVersion,o=t.appKey,a=n.app+"/"+o+"/web/",s={sdk_version:r},(null==e?void 0:e.language)&&(null==e?void 0:e.country)&&(s.language=e.language,s.country=e.country),[4,this._request.get(a,{queryParams:s})];case 1:if(!(u=i.sent()).ok)throw new Error("unexpected response");return[2,u.payloads]}}))}))},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return!("standalone"in navigator)||navigator.standalone}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(){var t=window.location.hostname;return!r.default.registrationDomain||t===r.default.registrationDomain}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),a=n(3);e.default=function(t){return r(this,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,t.registration.pushManager.getSubscription()];case 1:return e=i.sent(),n=e?t.location.hostname:null,[4,o.default.set("subscriptionDomain",n)];case 2:return i.sent(),[2,!0];case 3:return r=i.sent(),a.default("Error while storing subscription domain",r),[2,!1];case 4:return[2]}}))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AMPCommand=e.isChannelSubscriptionAction=e.isContactSubscriptionAction=void 0,e.isContactSubscriptionAction=function(t){return"contact"===t.type},e.isChannelSubscriptionAction=function(t){return"channel"===t.type},function(t){t.AMP_SUBSCRIPTION_STATE="amp-web-push-subscription-state",t.AMP_SUBSCRIBE="amp-web-push-subscribe",t.AMP_UNSUBSCRIBE="amp-web-push-unsubscribe"}(e.AMPCommand||(e.AMPCommand={}))},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.getActionUrl=e.expandAirshipAction=e.isAccPayload=e.isAirshipPayload=void 0;var o=n(0),a=n(50);e.isAirshipPayload=function(t){return"channel_id"in t&&"string"==typeof t.channel_id&&"string"==typeof t.send_id},e.isAccPayload=function(t){return"a4sid"in t&&"string"==typeof t.a4sid},e.expandAirshipAction=function(t){var e=t["^u"]||t["^d_a"]||t["^p_a"],n={};return n.open=e?{type:"url",content:e}:{type:"home"},t["^+t"]&&(n.add_tag=t["^+t"]),t["^-t"]&&(n.remove_tag=t["^-t"]),t["^sl"]&&(n.subscription_list=t["^sl"]),n},e.getActionUrl=function(t){var e,n;return"home"===(null===(e=t.open)||void 0===e?void 0:e.type)?o.default.defaultActionURL:"url"===(null===(n=t.open)||void 0===n?void 0:n.type)?t.open.content:null},e.default=function(t){return a.default().then((function(e){var n={channel_id:e,body:t.body,title:t.title,icon:t.icon,require_interaction:"reqInt"in t&&Boolean(t.reqInt)},o=function(t){var e,n;if(null==t?void 0:t.onClick){var o=new URL(t.onClick.url),a=o.searchParams;try{for(var s=r(Object.entries(t.onClick.params||{})),u=s.next();!u.done;u=s.next()){var c=i(u.value,2),l=c[0],f=c[1];a.set(l,f)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return o.search=a.toString(),o.toString()}}(t);return o&&(n.action={"^u":o}),t.a4sb&&Array.isArray(t.a4sb)&&t.a4sb.length&&(n.buttons=t.a4sb.reduce((function(t,e){var n={id:String(e.id),label:e.title,icon:e.icon,actions:{open:{type:"url",content:e.url}}};return t.push(n),t}),[])),"a4sbigpicture"in t&&(n.image=t.a4sbigpicture),n}))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),a=n(3);e.default=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o.default.get("channel")];case 1:return[2,null==(t=n.sent())?void 0:t.channel_id];case 2:return e=n.sent(),a.default("Error fetching channel ID from indexedDB",e),[3,3];case 3:return[2]}}))}))}},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(57),i=n(29),o=n(43),a=n(14),s=n(98);try{var u=document.getElementById("_uasdk"),c=u.rel,l=window;u&&c&&l[c]?"function"==typeof l[c]._async_setup?l[c]._async_setup((function(t){void 0===t&&(t={});if(i.default(t),!a.default()){var e=new Error("Browser is not supported");if("Promise"in window)return Promise.reject(e);throw e}var n=new r.default;return n._setup().then((function(){return n}))})):"function"==typeof l[c]._setup&&l[c]._setup((function(t){void 0===t&&(t={});if(i.default(t),!a.default())throw new Error("Browser is not supported");var e=new r.default;return e._legacySetup(),e})):u&&"secureBridge"===u.getAttribute("rel")&&(window.uaSetup={secureBridge:o.setupBridge})}catch(t){t instanceof ReferenceError&&self&&(self.uaSetup={worker:s.default})}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(35),u=n(2),c=n(22),l=n(0),f=n(41),d=n(19),h=n(43),p=n(12),v=n(81),y=n(83),b=n(89),g=n(44),_=n(90),m=n(20),w=n(9),S=n(23),P=n(91),M=n(1),O=n(92),E=n(3),A=n(93),x=n(5),C=n(94),k=n(95),T=n(4),j=n(42),I=n(45),N=n(46),R=n(7),L=n(21),B=n(14),D=n(6),U=n(97),F=n(24),q=n(8),G=function(t){function e(){var e=t.call(this)||this;e.dataCollectionEnabledSync=!0,e._registrationMutex=new s.default,e._isSetup=new A.default,e._channelPromise=new Promise((function(t){e.addEventListener("channel",(function(e){return t(e.detail)}),{once:!0})})),e._workerRegistration=k.default(),e._workerRegistration.catch((function(t){return E.default("SW Registration Error",t)})),e._channelPromise.then(e.heartbeat.bind(e)),e._channelPromise.then(e.checkPermission.bind(e)),e.isSupported=B.default(),e.isWebPushSupported=B.isWebPushSupported(),e.canRegister=P.default(),e.isRegistrationDomain=N.default(),e.gestureRequired=C.default(),e.isAllowedPushRegistrationContext=I.default(),e.setDataCollectionEnabled=function(t){return w.setDataCollectionEnabled(t,e)},e.isDataCollectionEnabled=w.isDataCollectionEnabled,l.default.secureBridgeUrl&&l.default.secureBridgeUrl.match(/accengage\.net/)&&!l.default.mixedRegistrationDomains&&console.warn("WARNING: you should set 'mixedRegistrationDomains' to true if you are migrating from Accengage and were using an Accengage-owned domain"),E.default("[main] Web SDK environment:");var n={isSecure:L.default(),isRegistrationDomain:e.isRegistrationDomain,mixedRegistrationDomains:l.default.mixedRegistrationDomains,secureBridgeUrl:l.default.secureBridgeUrl,allowedDomains:l.default.allowedDomains};l.default.secureBridgeUrl&&(n.sbOriginDifferentFromCurrent=new URL(l.default.secureBridgeUrl).origin!==window.location.origin),E.default(n);var r=(!L.default()||!e.isRegistrationDomain||l.default.mixedRegistrationDomains)&&l.default.secureBridgeUrl&&new URL(l.default.secureBridgeUrl).origin!==window.location.origin&&!R.default();if(r&&!l.default.secureBridgeUrl&&console.warn("Airship SDK is integrated on a non-secured domain but 'secureIframeUrl' is not provided."),e.hasExistingSubscription=Promise.resolve(),r&&l.default.secureBridgeUrl){if(h.setupIframe(e,l.default.secureBridgeUrl),l.default.mixedRegistrationDomains){var i=new Promise((function(t){e.addEventListener("subscriptiondomain",(function(e){return t(e.detail)}),{once:!0})}));e.hasExistingSubscription=Promise.race([i,U.promiseTimeout(1e3)])}}else e._channelPromise.then((function(t){return m.startSession(t)}));return e.channel=null,e.localeOverride=new p.default,e.CustomEvent=d.default,e.plugins=new v.default,e._contactPromise=e.createContact(),window.addEventListener("storage",q.default.onStorage((function(t){return e._set(t)}))),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",(function(t){"push"===t.data.type&&(E.default("Push event from worker",t),e.dispatchEvent({type:"push",push:t.data.push}))})),e}return i(e,t),e.prototype.createContact=function(){return o(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){switch(e.label){case 0:return[4,this._isSetup.promise];case 1:return e.sent(),[2,f.makeContact(l.default,(function(){return o(t,void 0,void 0,(function(){return a(this,(function(t){return[2,this.channel]}))}))}),(function(){return o(t,void 0,void 0,(function(){return a(this,(function(t){return[2,this.localeOverride]}))}))}),{isDataCollectionEnabled:this.isDataCollectionEnabled},this)]}}))}))},e.prototype.checkDataCollection=function(){var t=this;return Promise.resolve(this.dataCollectionEnabled).then((function(e){t.dataCollectionEnabledSync=e}))},e.prototype.checkPermission=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return l.default.mixedRegistrationDomains?[4,this.hasExistingSubscription]:[3,2];case 1:if(e.sent())return[2];e.label=2;case 2:return this.permission&&"granted"!==this.permission&&t.optedIn&&this.isRegistrationDomain&&t.optOut(),[2]}}))}))},e.prototype.heartbeat=function(t){var e=j.default("heartbeat",24),n=e.after,r=e.store;n&&(E.default("SENDING heartbeat"),r(),t.optedIn&&this.isRegistrationDomain?this.register().catch((function(){return t.update()})):t.update())},e.prototype.getChannel=function(){return this._channelPromise},e.prototype._legacySetup=function(){try{var t=q.default.getJSON("channel");(null==t?void 0:t.channel_id)&&this._setChannel(t),this._isSetup.resolve()}catch(t){throw this._isSetup.reject(t),t}},e.prototype._setup=function(){return o(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){switch(n.label){case 0:return[4,O.renameDbIfNeed()];case 1:return n.sent(),(t=[]).push(M.default.get("channel").then((function(t){t&&t.channel_id&&e._setChannel(t)})).then((function(){return p.default.getStoredLocale().then((function(t){e.localeOverride.set(t),e.channel&&e.localeOverride.setChannel(e.channel)}))}))),t.push(M.default.get("subscriptionDomain").then((function(t){t&&e._setSubscriptionDomain(t)}))),t.push(this.checkDataCollection()),[2,Promise.all(t).then((function(){return e._isSetup.resolve()})).catch((function(t){throw e._isSetup.reject(t),t}))]}}))}))},Object.defineProperty(e.prototype,"disableAnalytics",{get:function(){return M.default.get(l.default.consts.DISABLE_ANALYTICS).then((function(t){return!!t}))},set:function(t){M.default.set(l.default.consts.DISABLE_ANALYTICS,!!t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataCollectionEnabled",{get:function(){return w.isDataCollectionEnabled()},set:function(t){w.setDataCollectionEnabled(!!t,this),this.dataCollectionEnabledSync=!!t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"permission",{get:function(){var t;if(L.default())return null===(t=window.Notification)||void 0===t?void 0:t.permission},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contact",{get:function(){return this._contactPromise},enumerable:!1,configurable:!0}),e.prototype.register=function(){return o(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return[2,this._registrationMutex.acquireAsync().then((function(){return t._register(!0)})).finally((function(){return t._registrationMutex.release()}))]}))}))},e.prototype.create=function(){return o(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return[2,this._registrationMutex.acquireAsync().then((function(){var e,n;return t._register(null!==(n=null===(e=t.channel)||void 0===e?void 0:e.optedIn)&&void 0!==n&&n)})).finally((function(){return t._registrationMutex.release()}))]}))}))},e.prototype._register=function(t){return o(this,void 0,void 0,(function(){var e,n,r,i,o;return a(this,(function(a){switch(a.label){case 0:if(!R.default()){if(!L.default())return[2,Promise.reject("Registration not possible on a non-secure context.")];if(!this.isRegistrationDomain)return[2,Promise.reject("Domain is not allowed for registration.")]}if(t&&!this.isAllowedPushRegistrationContext)return[2,Promise.reject("Registration cannot happen in this context.")];if(!this.dataCollectionEnabledSync)return[2,Promise.reject("Data collection is disabled. Cannot register user.")];if(!this.isWebPushSupported)return[2,Promise.reject("Web push not supported in browser")];e=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._workerRegistration];case 2:return e=a.sent(),[3,4];case 3:return a.sent(),[3,4];case 4:return[4,this.hasExistingSubscription];case 5:return(n=a.sent())&&n!==D.default().hostname?[2,Promise.reject("An existing registration exists on "+n)]:[4,y.default(e,t)];case 6:return r=a.sent(),this.channel?[4,x.default(this.channel.path,{method:"put",body:r})]:[3,8];case 7:return i=a.sent(),[3,10];case 8:return[4,x.default(l.default.paths.cra,{method:"post",body:r})];case 9:i=a.sent(),a.label=10;case 10:return[4,i.json()];case 11:return o=a.sent(),(0,j.default("heartbeat",24).store)(),this._setSubscriptionDomain(D.default().hostname),[2,this._setChannel(o)]}}))}))},Object.defineProperty(e.prototype,"_intlDetails",{get:function(){return T.getIntlDetails(this.localeOverride)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_remoteData",{get:function(){var t=this;if(!this._remoteDataProvider){var e=new g.default({paths:l.default.paths.remote_data,sdkVersion:l.default.VERSION,appKey:l.default.appKey},F.createRequest(l.default)),n=new S.CacheStorageManager({ttlMs:l.default.remoteData.cacheTtlMs,prefix:l.default.storagePrefix},self.sessionStorage);this._remoteDataProvider=new b.default(e,(function(){return o(t,void 0,void 0,(function(){var t;return a(this,(function(e){return[2,{country:(t=this._intlDetails).localeCountry,language:t.localeLanguage}]}))}))}),new S.StorageGetCache(n))}return this._remoteDataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preferenceCenters",{get:function(){return this._preferenceCenterManager||(this._preferenceCenterManager=new _.default(this._remoteData)),this._preferenceCenterManager},enumerable:!1,configurable:!0}),e.prototype._set=function(t){void 0===t&&(t={}),t.channel&&t.channel.channel_id&&this._setChannel(t.channel),t.tags&&this.channel&&this.channel.tags.sync(t.tags),t.subscriptionDomain&&this._setSubscriptionDomain(t.subscriptionDomain),t.session&&this._setSession(t.session)},e.prototype._setSubscriptionDomain=function(t){M.default.set("subscriptionDomain",t);var e=new CustomEvent("subscriptiondomain",{detail:t});this.dispatchEvent(e)},e.prototype._setChannel=function(t){var e=this;return this.channel?(this.channel.set(t),this.channel):(this.channel=new c.default((function(){return e.contact}),t),this.localeOverride.setChannel(this.channel),this.channel.addEventListener("channel",(function(t){t.channel=t.detail,e.dispatchEvent(t)})),this.channel.tags.addEventListener("tags",(function(t){var n=new CustomEvent("tags",{detail:t.detail});n.tags=t.detail,e.dispatchEvent(n)})),this.channel)},e.prototype._setSession=function(t){q.default.setJSON("session",t),this._channelPromise.then((function(e){m.startSession(e,t)}))},Object.defineProperty(e.prototype,"isSetup",{get:function(){return this._isSetup.promise},enumerable:!1,configurable:!0}),e}(u.EventTarget);e.default=G},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(38),s=n(59),u=n(60),c=function(){function t(t){this._config=t}return t.prototype.get=function(t,e){return this._jsonRequestResponse("GET",t,e)},t.prototype.put=function(t,e,n){return this._jsonRequestResponse("PUT",t,n,e)},t.prototype.post=function(t,e,n){return this._jsonRequestResponse("POST",t,n,e)},t.prototype.patch=function(t,e,n){return this._jsonRequestResponse("PATCH",t,n,e)},t.prototype.delete=function(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,this._requestResponse("DELETE",t,null!=e?e:{})];case 1:return n.sent(),[2]}}))}))},t.prototype._authHeaders=function(){switch(this._config.type){case"basic":return{Authorization:"Basic "+self.btoa(this._config.appKey+":"+this._config.secret)};case"bearer":return{"X-UA-Appkey":this._config.appKey,Authorization:"Bearer "+this._config.token};default:var t=this._config;throw new Error("invalid config: "+t)}},t.prototype._requestResponse=function(e,n,c){var l=c.headers,f=c.queryParams,d=void 0===f?{}:f,h=c.body;return i(this,void 0,void 0,(function(){var i,c,f,p,v;return o(this,(function(o){switch(o.label){case 0:return i=new URL(""+this._config.apiBase+n),c={method:e},f=r({Accept:t.V3_ACCEPT_HEADER},this._authHeaders()),p=new URLSearchParams(i.search.slice(1)),Object.keys(d).forEach((function(t){a.default(d[t]).forEach((function(e){p.append(t,e.toString())}))})),i.search=p.toString(),c.credentials="include",h&&(f["Content-Type"]="application/json",c.body="string"==typeof h?h:JSON.stringify(h)),c.headers=r(r({},f),null!=l?l:{}),[4,u.default(i.toString(),c)];case 1:if(!(v=o.sent()).ok)throw new s.RequestError(v.status,v.statusText);return[2,v]}}))}))},t.prototype._jsonRequestResponse=function(t,e,n,r){var a=void 0===n?{}:n,u=a.headers,c=a.queryParams,l=a.predicate;return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return[4,this._requestResponse(t,e,{headers:u,queryParams:c,body:r})];case 1:return[4,i.sent().json()];case 2:if(n=i.sent(),l&&!l(n))throw new s.PredicateUnsatisfiedError;return[2,n]}}))}))},t.V3_ACCEPT_HEADER="application/vnd.urbanairship+json; version=3;",t}();e.default=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.RequestError=e.PredicateUnsatisfiedError=void 0;var o=function(t){function e(n){void 0===n&&(n="Predicate was not satisfied.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(TypeError);e.PredicateUnsatisfiedError=o;var a=function(t){function e(n,r){void 0===r&&(r="Request Error");var i=t.call(this,r)||this;return i._statusCode=n,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,e),i.name=i.constructor.name,i}return i(e,t),Object.defineProperty(e.prototype,"statusCode",{get:function(){return this._statusCode},enumerable:!1,configurable:!0}),e}(Error);e.RequestError=a},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return self.fetch.apply(self,i([],r(t)))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(9),u=n(39),c=n(5),l=n(18),f=function(){function t(t){this._getAudience=t}return t.prototype.set=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,s.isDataCollectionEnabled()];case 1:return e.sent()?[2,this.send(this.buildSetPayload(t))]:(console.warn("Data collection is disabled. Setting attributes is not allowed."),[2,!1])}}))}))},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.send(this.buildRemovePayload(t))},t.prototype.send=function(t,e){var n=void 0===e?{path:a.default.paths.attributes,method:"post"}:e,o=n.path,s=n.method;return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:if(t.attributes.length<1)return[2,Promise.resolve(!1)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c.default(o,{method:s,body:t})];case 2:return[2,n.sent().ok||Promise.reject(!1)];case 3:return e=n.sent(),[2,Promise.reject(e)];case 4:return[2]}}))}))},t.prototype.buildSetPayload=function(t){var e=o((new Date).toISOString().split("."),1)[0],n=Object.entries(t).map((function(t){var n=o(t,2),r=n[0],i=n[1];return{key:r,value:u.serializeAttributeValue(i),action:l.AttributeAction.SET,timestamp:e}}));return{audience:this._getAudience(),attributes:n}},t.prototype.buildRemovePayload=function(t){var e=o((new Date).toISOString().split("."),1)[0],n=t.map((function(t){return{key:t,action:l.AttributeAction.REMOVE,timestamp:e}}));return{audience:this._getAudience(),attributes:n}},t}();e.default=f},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});var s=n(63),u=n(25),c=n(40),l=n(18),f=function(){function t(t){var e=this,n=t.getName,s=t.setName,l=t.getChannelId,f=t.getContact;this._contact=f,this._getName=n,this._setName=s,this._getChannelId=l,this._attributes=new u.LegacyAttributeBridge((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this._contact()];case 1:return[2,t.sent().editAttributes()]}}))}))})),this._tags=c.default({storeName:"namedUserTags"},(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e._applyTags.apply(e,a([],o(t)))}),(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e._validateTagGroup.apply(e,a([],o(t)))}))}return Object.defineProperty(t.prototype,"id",{get:function(){return console.warn("accessing the `id` of a named user may return a non-canonical response. its use is deprecated."),this._getName()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"channelId",{get:function(){return this._getChannelId()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),t.prototype.set=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,this._contact()];case 1:return[4,(e=r.sent())._namedUserIdEquals(t)];case 2:if(n=r.sent(),!t||n)return[2,!1];r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.identify(t)];case 4:return r.sent(),this._setName(t),[2,!0];case 5:return r.sent(),[2,!1];case 6:return[2]}}))}))},t.prototype.remove=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return this._getName()?[4,this._contact()]:[2,!1];case 1:t=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t.reset()];case 3:return e.sent(),this._setName(null),[2,!0];case 4:return e.sent(),[2,!1];case 5:return[2]}}))}))},t.prototype._applyTags=function(t,e,n){return r(this,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return[4,this._contact()];case 1:return[4,i.sent().editTags()];case 2:switch(r=i.sent(),t){case l.TagAction.ADD:r.add(n,e);break;case l.TagAction.REMOVE:r.remove(n,e);break;case l.TagAction.SET:r.set(n,e);break;default:throw new Error("invalid tag action: "+t)}i.label=3;case 3:return i.trys.push([3,5,,6]),[4,r.apply()];case 4:return i.sent(),[2,!0];case 5:return i.sent(),[2,!1];case 6:return[2]}}))}))},t.prototype._validateTagGroup=function(t){if(void 0===t&&(t=""),!t.trim())throw Error("group is mandatory.");if("device"===t)throw Error('"device" group is not available for a named user.');return t},t}();f.prototype.set=s(f.prototype.set,1e3),e.default=f},function(t,e,n){"use strict";function r(t){return"function"==typeof t?t():t}function i(){var t={};return t.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),t}t.exports=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=void 0,a=void 0,s=void 0,u=[];return function(){var l=r(e),f=(new Date).getTime(),d=!o||f-o>l;o=f;for(var h=arguments.length,p=Array(h),v=0;v<h;v++)p[v]=arguments[v];if(d&&n.leading)return n.accumulate?Promise.resolve(t.call(this,[p])).then((function(t){return t[0]})):Promise.resolve(t.call.apply(t,[this].concat(p)));if(a?clearTimeout(s):a=i(),u.push(p),s=setTimeout(c.bind(this),l),n.accumulate){var y=u.length-1;return a.promise.then((function(t){return t[y]}))}return a.promise};function c(){var e=a;clearTimeout(s),Promise.resolve(n.accumulate?t.call(this,u):t.apply(this,u[u.length-1])).then(e.resolve,e.reject),u=[],a=null}}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(11),a=n(10),s=function(){function t(t,e,n){this._client=t,this._channel=e,this._datCollectionEnabled=n}return t.prototype.list=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._channel()];case 1:return t=e.sent(),[2,this._client.listSubscriptions(t)]}}))}))},t.prototype.edit=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:return[4,this._channel()];case 1:return t=n.sent(),[2,(s=function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._datCollectionEnabled()];case 1:if(!e.sent())throw new o.DataCollectionDisabledError;return[2,this._client.updateSubscriptions(t,n)]}}))}))},u=function(){function t(){this._mutations=[]}return t.prototype.apply=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,s(this._mutations)];case 1:return t.sent(),[2]}}))}))},t.prototype.subscribe=function(t){this._mutations.push({action:"subscribe",listId:t,timestamp:a.apiTimestamp()})},t.prototype.unsubscribe=function(t){this._mutations.push({action:"unsubscribe",listId:t,timestamp:a.apiTimestamp()})},t}(),new u)]}var s,u}))}))},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isPlatform=void 0;var r=["web","email","sms","open","ios","android","amazon"];e.isPlatform=function(t){return r.includes(t)}},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(10);e.default=function(t,e){return new(function(){function n(){this._mutations=i([],r(t))}return n.prototype.apply=function(){return e(this._mutations)},n.prototype.remove=function(t){this._mutations.push({action:"remove",key:t,timestamp:o.apiTimestamp()})},n.prototype.set=function(t,e){this._mutations.push({action:"set",key:t,value:e,timestamp:o.apiTimestamp()})},n}())}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.createContactClient=e.CachingContactClient=void 0;var o=n(23),a=n(28),s=n(25),u=function(){function t(t,e,n){this._client=t,this._cache=e,this._mutationCache=n}return t.prototype.identify=function(t,e,n){return this._client.identify(t,e,n)},t.prototype.resolve=function(t,e){return this._client.resolve(t,e)},t.prototype.reset=function(t,e){return this._client.reset(t,e)},t.prototype.updateAttributes=function(t,e){return this._client.updateAttributes(t,e)},t.prototype.updateTags=function(t,e){return this._client.updateTags(t,e)},t.prototype._subscriptionCacheKey=function(t){return t+":subscription_lists"},t.prototype.listSubscriptions=function(t){return r(this,void 0,void 0,(function(){var e,n,r=this;return i(this,(function(i){switch(i.label){case 0:return[4,this._cache.get(this._subscriptionCacheKey(t),(function(){return r._client.listSubscriptions(t)}))];case 1:return e=i.sent(),n=this._mutationCache.values(),[2,a.updateScopedIdentifierFromMutations(e,n)]}}))}))},t.prototype.updateSubscriptions=function(t,e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return[4,this._client.updateSubscriptions(t,e)];case 1:return r.sent(),e.forEach((function(t){n._mutationCache.push(t)})),this._cache.invalidate(this._subscriptionCacheKey(t)),[2]}}))}))},t.prototype.associateChannel=function(t,e){return this._client.associateChannel(t,e)},t}();e.CachingContactClient=u;var c=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.identify=function(t,e,n){var o=void 0===n?{}:n,a=o.platform,s=void 0===a?"web":a,u=o.contactId;return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return n=this._config.paths.identify,r={named_user_id:t,channel_id:e,device_type:s},u&&(r.contact_id=u),[4,this._request.post(n,r)];case 1:return[2,i.sent().contact_id]}}))}))},t.prototype.resolve=function(t,e){var n=(void 0===e?{}:e).platform,o=void 0===n?"web":n;return r(this,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:return e=this._config.paths.resolve,n={channel_id:t,device_type:o},[4,this._request.post(e,n)];case 1:return[2,[(r=i.sent()).contact_id,r.is_anonymous]]}}))}))},t.prototype.reset=function(t,e){var n=(void 0===e?{}:e).platform,o=void 0===n?"web":n;return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return e=this._config.paths.reset,n={channel_id:t,device_type:o},[4,this._request.post(e,n)];case 1:return[2,r.sent().contact_id]}}))}))},t.prototype.updateAttributes=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this._batch(t,{attributes:e})]}))}))},t.prototype.updateTags=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this._batch(t,{tags:e})]}))}))},t.prototype.listSubscriptions=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return e=this._config.paths.subscription_lists_list+"/"+t,[4,this._request.get(e)];case 1:return n=r.sent(),[2,s.groupListsById(n.subscription_lists)]}}))}))},t.prototype.updateSubscriptions=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this._batch(t,{subscriptionLists:e})];case 1:return n.sent(),[2]}}))}))},t.prototype._batch=function(t,e){var n=e.attributes,o=void 0===n?[]:n,u=e.tags,c=void 0===u?[]:u,l=e.associate,f=void 0===l?[]:l,d=e.subscriptionLists,h=void 0===d?[]:d;return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return e=this._config.paths.batch+"/"+t,n={},o.length&&(n.attributes=s.serializeAttributeMutations(o)),c.length&&(n.tags=s.serializeTagMutations(c)),h.length&&(n.subscription_lists=a.serializeScopedSubscriptionListMutations(h)),f.length&&(n.associate=f.map((function(t){return{channel_id:t.channelId,device_type:t.platform}}))),[4,this._request.post(e,n)];case 1:return r.sent(),[2]}}))}))},t.prototype.associateChannel=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this._batch(t,{associate:[e]})]}))}))},t}();e.createContactClient=function(t,e){var n=new c(t,e),r=new o.CacheStorageManager({prefix:t.storagePrefix,ttlMs:t.cacheTtlMs},self.sessionStorage),i=new o.StorageGetCache(r),a=new o.ArrayCache({indexKey:"contact",keyFn:function(t){return t.listId+":"+t.scope}},r);return new u(n,i,a)},e.default=c},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(10),s=n(69),u=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.registerEmail=function(t,e){return i(this,void 0,void 0,(function(){var n,i;return o(this,(function(o){return n=r({type:"email",address:t,transactional_opted_in:l(e.transactionalOptedIn)},c(e)),s.isEmailRegistrationCommercialOptions(e)&&(n.commercial_opted_in=l(e.commercialOptedIn)),i={},s.isEmailRegistrationDoubleOptInOptions(e)&&(i.opt_in_mode="double"),e.properties&&(i.properties=e.properties),[2,this._register(this._config.paths.email,n,{registrationOptions:i})]}))}))},t.prototype.registerSms=function(t,e){return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return n=r({msisdn:t,sender:e.senderId},c(e)),[4,this._request.post(this._config.paths.sms,n)];case 1:return[2,i.sent().channel_id]}}))}))},t.prototype.registerOpen=function(t,e){return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){return n=r({type:"open",address:t,opt_in:!0,open:{open_platform_name:e.platformName,identifiers:e.identifiers}},c(e)),[2,this._register(this._config.paths.open,n)]}))}))},t.prototype._register=function(t,e,n){var a=(void 0===n?{}:n).registrationOptions;return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return n=r({channel:e},a),[4,this._request.post(t,n)];case 1:return[2,i.sent().channel_id]}}))}))},t}();function c(t){return{timezone:t.timezone,locale_country:t.localeCountry,locale_language:t.localeLanguage}}function l(t){if(t)return a.apiTimestamp(t)}e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isEmailRegistrationDoubleOptInOptions=e.isEmailRegistrationCommercialOptions=void 0,e.isEmailRegistrationCommercialOptions=function(t){return!t.doubleOptIn},e.isEmailRegistrationDoubleOptInOptions=function(t){return Boolean(t.doubleOptIn)}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});var s=n(17),u=function(t){return"contact."+t+".tag_mutations"},c=function(t){return"contact."+t+".attribute_mutations"},l=function(t){return"contact."+t+".subscription_list_mutations"},f=function(t){return"contact."+t+".associated_channels"},d=function(){function t(t,e,n){var r=t.prefix,i=t.sessionLengthMs,o=t.namedUserTtlMs,a=t._forceExpireNamedUsers,s=t._getNow;this._db=e,this._session=n,this._prefix=r,this._sessionLengthMs=i,this._namedUserTtlMs=o,this._forceExpireNamedUsers=a,this._getNow=null!=s?s:function(){return Date.now()}}return t.prototype._key=function(t){return this._prefix+":"+t},t.prototype.sessionResolved=function(){var t,e;return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){return n=this._key("session_resolved_timestamp"),(r=null===(t=this._session)||void 0===t?void 0:t.getItem(n))?(o=Number.parseInt(r,10),Number.isNaN(o)?(null===(e=this._session)||void 0===e||e.removeItem(n),[2,!1]):[2,this._getNow()-o<this._sessionLengthMs]):[2,!1]}))}))},t.prototype.setSessionResolved=function(t){var e,n;return r(this,void 0,void 0,(function(){var r;return i(this,(function(i){return r=this._key("session_resolved_timestamp"),[2,t?null===(e=this._session)||void 0===e?void 0:e.setItem(r,String(this._getNow())):null===(n=this._session)||void 0===n?void 0:n.removeItem(r)]}))}))},t.prototype.getOrCreateContactId=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._db.get("contact.id")];case 1:return(t=e.sent())?[3,3]:(t=s.v4(),[4,this.setContactId(t)]);case 2:e.sent(),e.label=3;case 3:return[2,t]}}))}))},t.prototype.setContactId=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._db.set("contact.id",t)];case 1:return e.sent(),[2]}}))}))},t.prototype.clearContactId=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=s.v4(),[4,this._db.set("contact.id",t)];case 1:return e.sent(),[2,t]}}))}))},t.prototype.getNamedUserId=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return[4,this.getNamedUserAssociatedTimestamp()];case 1:return!(t=n.sent())&&this._forceExpireNamedUsers||t&&this._getNow()-t>this._namedUserTtlMs?[2]:[4,this._db.get("contact.name")];case 2:return(e=n.sent())&&!t&&this.setNamedUserAssociatedTimestamp(),[2,e]}}))}))},t.prototype.setNamedUserId=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._db.set("contact.name",t)];case 1:return e.sent(),[4,this.setNamedUserAssociatedTimestamp()];case 2:return e.sent(),[2]}}))}))},t.prototype.clearNamedUserId=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this._db.remove("contact.name")];case 1:return t.sent(),[4,this.clearNamedUserAssociatedTimestamp()];case 2:return t.sent(),[2]}}))}))},t.prototype.setNamedUserAssociatedTimestamp=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this._db.set("contact.named_user_associated",String(this._getNow())),[2]}))}))},t.prototype.clearNamedUserAssociatedTimestamp=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this._db.remove("contact.named_user_associated"),[2]}))}))},t.prototype.getNamedUserAssociatedTimestamp=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return[4,this._db.get("contact.named_user_associated")];case 1:return(t=n.sent())?(e=Number.parseInt(t,10),Number.isNaN(e)?[4,this.clearNamedUserAssociatedTimestamp()]:[3,3]):[2];case 2:return n.sent(),[2];case 3:return[2,e]}}))}))},t.prototype.getPendingTagMutations=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._db.get("contact.pending_tag_mutations")];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingTagMutations=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._db.set("contact.pending_tag_mutations",t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendTagMutations=function(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getTagMutations(t)];case 1:return n=r.sent(),[4,this._db.set(u(t),n.concat.apply(n,a([],o(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getTagMutations=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this._db.get(u(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getPendingAttributeMutations=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._db.get("contact.pending_attribute_mutations")];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingAttributeMutations=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._db.set("contact.pending_attribute_mutations",t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendAttributeMutations=function(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getAttributeMutations(t)];case 1:return n=r.sent(),[4,this._db.set(c(t),n.concat.apply(n,a([],o(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getAttributeMutations=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this._db.get(c(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getPendingSubscriptionListMutations=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._db.get("contact.pending_subscription_list_mutations")];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingSubscriptionListMutations=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._db.set("contact.pending_subscription_list_mutations",t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendSubscriptionListMutations=function(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getSubscriptionListMutations(t)];case 1:return n=r.sent(),[4,this._db.set(l(t),n.concat.apply(n,a([],o(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getSubscriptionListMutations=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this._db.get(l(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getAssociatedChannels=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,this._db.get(f(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.appendAssociatedChannel=function(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getAssociatedChannels(t)];case 1:return n=r.sent(),[4,this._db.set(f(t),a(a([],o(n)),[e]))];case 2:return r.sent(),[2]}}))}))},t.prototype.clearAssociatedChannels=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._db.remove(f(t))];case 1:return e.sent(),[2]}}))}))},t}();e.default=d},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.createListEditor=void 0;var s=n(11),u=n(10),c=function(){function t(t,e,n,r,i){this._client=t,this._storage=e,this._contact=n,this._dataCollectionEnabled=r,this._isRelevantToAirship=i}return t.prototype.list=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._contact()];case 1:return t=e.sent(),[2,this._client.listSubscriptions(t)]}}))}))},t.prototype.edit=function(){return r(this,void 0,void 0,(function(){var t,e,n,o=this;return i(this,(function(a){switch(a.label){case 0:return[4,this._contact()];case 1:return t=a.sent(),e=function(e){return r(o,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this._dataCollectionEnabled()];case 1:if(!n.sent())throw new s.DataCollectionDisabledError;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingSubscriptionListMutations(e)];case 3:return n.sent(),[2];case 4:return e.length?[4,this._client.updateSubscriptions(t,e)]:[3,8];case 5:return n.sent(),[4,this._storage.setPendingSubscriptionListMutations([])];case 6:return n.sent(),[4,this._storage.appendSubscriptionListMutations(t,e)];case 7:n.sent(),n.label=8;case 8:return[2]}}))}))},n=l,[4,this._storage.getPendingSubscriptionListMutations()];case 2:return[2,n.apply(void 0,[a.sent(),e])]}}))}))},t}();function l(t,e){return new(function(){function n(){this._mutations=a([],o(t))}return n.prototype.apply=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,e(this._mutations)];case 1:return t.sent(),[2]}}))}))},n.prototype.subscribe=function(t,e){this._mutations.push({action:"subscribe",listId:t,timestamp:u.apiTimestamp(),scope:e})},n.prototype.unsubscribe=function(t,e){this._mutations.push({action:"unsubscribe",listId:t,timestamp:u.apiTimestamp(),scope:e})},n}())}e.default=c,e.createListEditor=l},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),a=n(26),s=["device"],u=["ua_"];function c(t){if(s.includes(t))throw new a.InvalidTagGroupError("invalid tag group for contact: "+t);if(u.some((function(e){return t.startsWith(e)})))throw new a.InvalidTagGroupError("forbidden tag group prefix for contact: "+t)}e.default=function(t,e){return new(function(){function n(){this._mutations=i([],r(t))}return n.prototype.apply=function(){return e(this._mutations)},n.prototype.add=function(t,e){c(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"add",tags:n,group:t,timestamp:o.apiTimestamp()})},n.prototype.remove=function(t,e){c(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"remove",tags:n,group:t,timestamp:o.apiTimestamp()})},n.prototype.set=function(t,e){c(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"set",tags:n,group:t,timestamp:o.apiTimestamp()})},n}())}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.default=function(t){return void 0===t&&(t=Date.now()),r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,o.default.get("last_send_id")];case 1:return(e=n.sent())&&t-e.timestamp<=2e4?[4,o.default.remove("last_send_id")]:[3,3];case 2:return n.sent(),[2,e.id];case 3:return[2]}}))}))}},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrings=void 0;e.checkStrings=function(t,e,n){var i,o;void 0===n&&(n="CustomEvent");try{for(var a=r(e),s=a.next();!s.done;s=a.next()){var u=s.value,c=t[u];if(void 0===c)return;if("string"!=typeof c)throw new TypeError(n+"."+u+" must be a string");if("string"==typeof c&&c.length>255)throw new RangeError(n+"."+u+" has a 255 character limit")}}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}},function(t,e){t.exports=function(t){return"string"==typeof t&&n.test(t)&&!isNaN(Date.parse(t))};var n=new RegExp("^\\d{4}-\\d{2}-\\d{2}((T\\d{2}:\\d{2}(:\\d{2})?)(\\.\\d{1,6})?(Z|(\\+|-)\\d{2}:\\d{2})?)?$")},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,n,r){void 0===n&&(n={});var i=t.call(this,"registered_account",e,n,r)||this;return i.templateType="account",i}return i(e,t),e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(n(19).default);e.default=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,e,n,r,i)||this;return o.templateType="media",o}return i(e,t),e.prototype.validate=function(){this._validateBooleanProperty("feature"),this._validateIsoDateProperty("published_date"),t.prototype.validate.call(this)},e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(n(19).default),a=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"browsed_content",e,n,r)||this}return i(e,t),e}(o),s=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"consumed_content",e,n,r)||this}return i(e,t),e}(o),u=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"starred_content",e,n,r)||this}return i(e,t),e}(o),c=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,"shared_content",void 0,r,i)||this;return o.properties.source=e,o.properties.medium=n,o}return i(e,t),e}(o);e.default={_MediaEvent:o,BrowsedContentEvent:a,ConsumedContentEvent:s,StarredContentEvent:u,SharedContentEvent:c}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,e,n,r,i)||this;return o.templateType="retail",o}return i(e,t),e.prototype.validate=function(){this._validateBooleanProperty("new_item"),t.prototype.validate.call(this)},e}(n(19).default),a=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"browsed",e,n,r)||this}return i(e,t),e}(o),s=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"added_to_cart",e,n,r)||this}return i(e,t),e}(o),u=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"purchased",e,n,r)||this}return i(e,t),e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(o),c=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"starred_product",e,n,r)||this}return i(e,t),e}(o),l=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,"shared_product",void 0,r,i)||this;return o.properties.source=e,o.properties.medium=n,o}return i(e,t),e}(o);e.default={_RetailEvent:o,AddedToCartEvent:s,BrowsedEvent:a,PurchasedEvent:u,StarredProductEvent:c,SharedProductEvent:l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.secureIframeUrl||t.secureBridgeUrl?t.secureIframeUrl||t.secureBridgeUrl:t.registrationDomain&&t.secureBridgePath?new URL(t.secureBridgePath,"https://"+t.registrationDomain).href:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getTargetOrigin=e.prefixObject=e.getMessageDataFrom=e.debounceMessage=void 0;var r=n(0),i=n(6);function o(t,e){var n=t.data[r.default.storagePrefix];return"*"!==e&&t.origin!==e||!n?{}:n}e.debounceMessage=function(t,e){var n,r={};return function(i){window.clearTimeout(n);var a=o(i,e);Object.assign(r,a),n=window.setTimeout((function(){t(r),r={}}),20)}},e.getMessageDataFrom=o,e.prefixObject=function(t){var e;return(e={})[r.default.storagePrefix]=t,e},e.getTargetOrigin=function(t){if(Array.isArray(t)&&t.length){var e=new URL(i.default().href).searchParams.get("__ua_secondary_origin");if(!e)throw new Error("Secondary origin not specified. Missing `__ua_secondary_origin` query parameter.");if(!t.includes(e)&&e!==i.default().origin)throw new Error("Secondary origin not allowed. Got: "+e+". Allowed: "+JSON.stringify(t));return e}return"http://"+i.default().host}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var a=n(82),s=function(){function t(){this.plugins=new Map,this.loaders=new Map}return Object.defineProperty(t.prototype,"list",{get:function(){var t,e,n=[];try{for(var r=o(this.plugins.keys()),i=r.next();!i.done;i=r.next()){var a=i.value;n.push(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),t.prototype.load=function(t,e,n){var r=this,i=this.loaders.get(t);if(i)return i;var o=new Promise((function(i){var o={url:e,opts:n,setLoaded:function(t){i(t)}};r.plugins.set(t,o)}));return this.loaders.set(t,o),a.default(t,e).addEventListener("error",(function(){throw r.loaders.delete(t),new Error("Error while loading plugin at URL: '"+e+"'")})),o},t.prototype._setLoaded=function(t,e,n){var r=this.plugins.get(t);if(!r)throw new Error("Airship Plugin "+t+" does not match any currently loading plugins: "+this.list.join(", "));return r.setLoaded(e(r.opts,n))},t.prototype.get=function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){if(e=this.loaders.get(t))return[2,e];throw new Error("The plugin '"+t+"' is not loaded. Make sure you have called plugins.load(...) correctly.")}))}))},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){void 0===n&&(n=document);var r=n.createElement("script");return r.src=e,r.async=!0,r.setAttribute("rel",t),n.head.appendChild(r),r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),i=n(84),o=n(7),a=n(13),s=n(85),u=n(30),c=n(86),l=n(31);e.default=function(t,e){return(o.default()||i.default())&&e?c.default().then((function(t){return r.default.fromStorage().then((function(n){var r=a.default({optedIn:e,localeOverride:n});return s.default(t,r)}))})):o.default()?r.default.fromStorage().then((function(t){return{channel:a.default({optedIn:!1,localeOverride:t})}})):t&&e?(n=t,Notification.requestPermission().then((function(t){if("granted"===t)return n;throw new Error("Notification permission is denied.")}))).then(l.default).then((function(t){return r.default.fromStorage().then((function(e){var n=a.default({optedIn:!0,localeOverride:e});return u.default(t,n)}))})):t?r.default.fromStorage().then((function(t){return{channel:a.default({optedIn:!1,localeOverride:t})}})):Promise.reject("Worker registration failed");var n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return void 0===t&&(t=self),!(!("safari"in t)||!r.default.websitePushId)&&"granted"===t.safari.pushNotification.permission(r.default.websitePushId).permission}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return e.push_address="granted"===t.permission?t.deviceToken:void 0,e.web.subscription={subscription_type:"apns"},{channel:e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(6);e.default=function(){var t=r.default.websitePushId;return"string"!=typeof t?Promise.reject("No websitePushId configured."):new Promise((function(e,n){window.safari.pushNotification.requestPermission(new window.URL(r.default.appKey+"/",r.default.safariServiceUrl).href,t,{},(function(t){if("granted"===t.permission)return e(t);n("Registration failed: permission denied.\nYou may want to check that '"+i.default().host+"' is one of your allowed domains.")}))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e;try{e=window}catch(t){e=self}for(var n=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=e.atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return t.length===e.length&&t.every((function(t,n){return t===e[n]}))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,n){this._client=t,this._locale=e,this._cache=n}return t.prototype.get=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:return[4,this._locale()];case 1:return t=n.sent(),[2,this._cache.get(this._cacheKey(t),(function(){return e._client.get({locale:t})}))]}}))}))},t.prototype._cacheKey=function(t){var e,n;return"remote_data:"+[null!==(e=t.language)&&void 0!==e?e:"default",null!==(n=t.country)&&void 0!==n?n:"default"].join("-")},t}();e.default=o},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var a=n(44),s=function(){function t(t){this._remote=t}return t.prototype.get=function(t){return r(this,void 0,void 0,(function(){var e,n,r,a,s,u;return i(this,(function(i){switch(i.label){case 0:return[4,this.list()];case 1:e=i.sent();try{for(n=o(e),r=n.next();!r.done;r=n.next())if((a=r.value).id===t)return[2,a]}catch(t){s={error:t}}finally{try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(s)throw s.error}}return[2,null]}}))}))},t.prototype.list=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return[4,this._remote.get()];case 1:return t=n.sent(),e=[],t.filter(a.isPreferenceCenterPayload).forEach((function(t){t.data.preference_forms.forEach((function(t){return e.push(t.form)}))})),[2,e]}}))}))},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(45),i=n(46),o=n(21),a=n(14);e.default=function(){return Boolean(a.isWebPushSupported()&&o.default()&&i.default()&&r.default()&&"denied"!==Notification.permission)}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.renameDbIfNeed=void 0;var o=n(0),a=n(1),s=n(36);e.renameDbIfNeed=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return o.default.deprecatedStoragePrefix?[4,a.default.count()]:[2,!1];case 1:return t.sent()?[2,!1]:[4,s.default((function(){return o.default.deprecatedStoragePrefix+":db"}),"blob",{keyPath:"type"},(function(t){var e;return null===(e=t.target.result)||void 0===e?void 0:e.value}),1).copy(a.default)];case 2:return t.sent(),[2,!0]}}))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(37);e.default=function(){var t,e=r.parse(navigator.userAgent).browser,n=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())||"",i=(null==e?void 0:e.version)?parseFloat(e.version):0;return n.includes("safari")&&i>=12.1||n.includes("firefox")&&i>=72}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(7),o=n(96);e.default=function(){return!i.default()&&navigator.serviceWorker?navigator.serviceWorker.register(r.default.workerUrl).then(o.default):Promise.reject("Worker registration not available in this context")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=["activating","activated"];e.default=function(t){return new Promise((function(e,n){t.active&&e(t);var i=t.installing||t.waiting;i?i.addEventListener("statechange",(function(){r.includes(i.state)&&e(t)})):n("Service worker in an unknown state")}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.promiseTimeout=void 0,e.promiseTimeout=function(t){return new Promise((function(e){setTimeout(e,t)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(29),i=n(99),o=n(100),a=n(102),s=n(104),u=n(105);e.default=function(t,e){void 0===e&&(e={}),r.default(e),t.addEventListener("message",(function(e){o.isAMPMessage(e)&&o.default(t,e)})),t.addEventListener("push",(function(e){return s.default(t,e)})),t.addEventListener("notificationclick",(function(e){return a.default(t,e)})),t.addEventListener("activate",(function(e){return i.default(t,e)})),t.addEventListener("pushsubscriptionchange",(function(e){return u.default(t,e)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(47);e.default=function(t,e){e.waitUntil(Promise.all([t.clients.claim(),r.default(t)]))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.isAMPMessage=void 0;var o=n(22),a=n(32),s=n(12),u=n(1),c=n(3),l=n(101),f=n(48);function d(t,e,n){t.clients.matchAll().then((function(t){for(var r=0;r<t.length;r++){t[r].postMessage({command:e,payload:n})}}))}e.default=function(t,e){switch(e.data.command){case f.AMPCommand.AMP_SUBSCRIPTION_STATE:!function(t){var e;r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,t.registration.pushManager.getSubscription()];case 1:return n=i.sent(),[4,a.default.fromStorage(u.default,(function(){return s.default.fromStorage()}))];case 2:return r=i.sent(),o=null!==n&&(null===(e=null==r?void 0:r.optedIn)||void 0===e||e)&&"granted"===Notification.permission,c.default("AMP[onMessageReceivedSubscriptionState]",{channel:r,isSubscribed:o,permission:Notification.permission}),d(t,f.AMPCommand.AMP_SUBSCRIPTION_STATE,o),[2]}}))}))}(t);break;case f.AMPCommand.AMP_SUBSCRIBE:!function(t){c.default("AMP[onMessageReceivedSubscribe]"),l.handleAMPRegistration(t.registration).then((function(){return d(t,f.AMPCommand.AMP_SUBSCRIBE,null)}))}(t);break;case f.AMPCommand.AMP_UNSUBSCRIBE:!function(t){o.default.fromStorage((function(){throw new Error("contact not available in this context")})).then((function(t){return t&&t.optOut()})).then((function(){return d(t,f.AMPCommand.AMP_UNSUBSCRIBE,null)}))}(t)}},e.isAMPMessage=function(t){var e=Object.values(f.AMPCommand);return t.data&&e.includes(t.data.command)}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.handleAMPRegistration=void 0;var o=n(32),a=n(27),s=n(0),u=n(13),c=n(30),l=n(31),f=n(1),d=n(3),h=n(5);function p(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return[4,l.default(t)];case 1:return[4,v(i.sent(),e)];case 2:return n=i.sent(),r=y,[4,n.json()];case 3:return[2,r.apply(void 0,[i.sent()])]}}))}))}function v(t,e){var n=function(t,e){var n=e?{identity_hints:{accengage_device_id:e}}:{},r=c.default(t,u.default({optedIn:!0}));return Object.assign(r,n)}(t,e);return h.default(s.default.paths.cra,{method:"post",body:n})}function y(t){var e,n=new o.default({channelId:t.channel_id,namedUserId:null!==(e=t.named_user_id)&&void 0!==e?e:void 0,optedIn:a._convertOptInStorageValue(t.opt_in)});return f.default.set("channel",n.toJSON())}e.handleAMPRegistration=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){try{return[2,p(t)]}catch(t){n=t,d.default("Unable to migrate registration on service worker startup.","Proceeding with installation.",n)}var n;return[2]}))}))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.handleSubscriptions=void 0;var o=n(22),a=n(32),s=n(0),u=n(41),c=n(12),l=n(20),f=n(9),d=n(38),h=n(1),p=n(5),v=n(49),y=n(103);function b(t,e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){var n,a;return i(this,(function(l){return e.subscription_list&&e.subscription_list.length?(n=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,o.default.fromStorage((function(){return a})).then((function(e){return null!=e?e:new o.default((function(){return a}),{channel_id:t,opt_in:!0})}))]}))}))}(),a=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,Promise.resolve(u.makeContact(s.default,(function(){return n}),(function(){return c.default.fromStorage()}),{isDataCollectionEnabled:f.isDataCollectionEnabled}))]}))}))}(),[2,new y.SubscriptionActionManager((function(){return n}),(function(){return a})).handleActions(e)]):[2,!0]}))}))}e.default=function(t,e){var n,o;e.notification.close();var u,f,y=e.action,g=e.notification.data;f=y?null!==(o=null==(u=null===(n=g.buttons)||void 0===n?void 0:n.find((function(t){return t.id===y})))?void 0:u.actions)&&void 0!==o?o:{}:v.expandAirshipAction(g.action||{});var _=g.channel_id,m=g.send_id,w=[],S=v.getActionUrl(f);if(S&&t.clients.openWindow&&w.push(t.clients.openWindow(S)),_&&(w.push(function(t,e){void 0===e&&(e={});return r(this,void 0,void 0,(function(){var n,r,o,a;return i(this,(function(i){switch(i.label){case 0:if(n=d.maybeArrayify(e.add_tag),r=d.maybeArrayify(e.remove_tag),!n&&!r)return[2,!0];o={audience:{channel:t}},n&&(o.add={device:n}),r&&(o.remove={device:r}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,p.default(s.default.paths.tags,{method:"post",body:o})];case 2:return[2,i.sent().ok];case 3:return a=i.sent(),console.error(a),[2,!1];case 4:return[2]}}))}))}(_,f)),w.push(b(_,f))),m&&_){var P=a.default.fromStorage(h.default,(function(){return c.default.fromStorage()})).then((function(t){return t=null!=t?t:new a.default({channelId:_,optedIn:!0}),y?l.buttonClick(t,m,y):l.direct(t,m)}));w.push(P,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,h.default.set("last_send_id",{id:t,timestamp:e})];case 2:return n.sent(),[2,!0];case 3:return n.sent(),[2,!1];case 4:return[2]}}))}))}(m))}var M=Promise.all(w);return e.waitUntil(M),M.then((function(){return!0}))},e.handleSubscriptions=b},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.SubscriptionActionManager=void 0;var o=n(48),a=function(){function t(t,e){this._channel=t,this._contact=e}return t.prototype.handleActions=function(t){var e,n;return r(this,void 0,void 0,(function(){var r,a,s;return i(this,(function(i){return r=null===(e=t.subscription_list)||void 0===e?void 0:e.filter(o.isContactSubscriptionAction),a=null===(n=t.subscription_list)||void 0===n?void 0:n.filter(o.isChannelSubscriptionAction),s=[],(null==r?void 0:r.length)&&s.push(this._handleContactSubscriptions(r)),(null==a?void 0:a.length)&&s.push(this._handleChannelSubscriptions(a)),[2,Promise.all(s).then((function(t){return t.every(Boolean)}))]}))}))},t.prototype._handleContactSubscriptions=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,this._contact()];case 1:return[4,r.sent().subscriptions.edit()];case 2:e=r.sent(),t.forEach((function(t){"subscribe"===t.action?e.subscribe(t.list,t.scope):e.unsubscribe(t.list,t.scope)})),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.apply()];case 4:return r.sent(),[2,!0];case 5:return n=r.sent(),console.error(n),[2,!1];case 6:return[2]}}))}))},t.prototype._handleChannelSubscriptions=function(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,this._channel()];case 1:return[4,r.sent().subscriptions.edit()];case 2:e=r.sent(),t.forEach((function(t){"subscribe"===t.action?e.subscribe(t.list):e.unsubscribe(t.list)})),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.apply()];case 4:return r.sent(),[2,!0];case 5:return n=r.sent(),console.error(n),[2,!1];case 6:return[2]}}))}))},t}();e.SubscriptionActionManager=a},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(49),u=n(47);e.default=function(t,e){var n,c=function(t,e){var n;return r(this,void 0,void 0,(function(){var c,l,f,d,h;return i(this,(function(p){switch(p.label){case 0:return[4,s.isAccPayload(e)?s.default(e):Promise.resolve(e)];case 1:return c=p.sent(),(l=[u.default(t)]).push(function(t,e){var n={type:"push",push:e};return t.clients.matchAll().then((function(t){t.forEach((function(t){return t.postMessage(n)}))}))}(t,c)),f=c.title||a.default.defaultTitle,d=c.require_interaction||!1,h=c.send_id,c.body&&l.push(t.registration.showNotification(f,{body:c.body,icon:c.icon||a.default.defaultIcon,image:c.image,data:c,actions:null===(n=c.buttons)||void 0===n?void 0:n.map((function(t){return{title:t.label,action:t.id,icon:t.icon}})),requireInteraction:d})),[2,Promise.all(l).catch((function(t){return console.error("error processing notification",t)})).then((function(){return function(t,e){return r(this,void 0,void 0,(function(){var n,r,a,s,u,c,l;return i(this,(function(i){switch(i.label){case 0:return[4,t.registration.getNotifications()];case 1:if(!(n=i.sent()))return[2];r=Date.now()/1e3;try{for(a=o(n),s=a.next();!s.done;s=a.next())u=s.value,e&&u.data.send_id===e||u.data.expiry&&u.data.expiry<r&&u.close()}catch(t){c={error:t}}finally{try{s&&!s.done&&(l=a.return)&&l.call(a)}finally{if(c)throw c.error}}return[2]}}))}))}(t,h)})).catch((function(t){return console.error("error clearing notifications",t)}))]}}))}))}(t,(null===(n=e.data)||void 0===n?void 0:n.json())||{});return e.waitUntil(c),c}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),a=n(13),s=n(30),u=n(31),c=n(3),l=n(5),f=n(50);function d(t,e){var n=s.default(t,a.default({optedIn:!0})),r=o.default.paths.cra+"/"+e;return l.default(r,{method:"put",body:n})}e.default=function(t,e){return r(this,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,u.default(t.registration)];case 1:return e=i.sent(),[4,f.default()];case 2:return(n=i.sent())?[2,d(e,n)]:[2];case 3:return r=i.sent(),c.default("Error in changeEventHandler: %s",r),[3,4];case 4:return[2]}}))}))}}]);